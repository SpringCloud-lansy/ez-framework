<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4-dev">
<meta name="author" content="gudaoxuri">
<title>EZ-Framework(EZ.F) Document</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary {
    display: block;
}

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video {
    display: inline-block;
}

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) {
    display: none;
    height: 0;
}

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template {
    display: none;
}

script {
    display: none !important;
}

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html {
    font-family: sans-serif; /* 1 */
    -ms-text-size-adjust: 100%; /* 2 */
    -webkit-text-size-adjust: 100%; /* 2 */
}

/** Remove default margin. */
body {
    margin: 0;
}

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a {
    background: transparent;
}

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus {
    outline: thin dotted;
}

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover {
    outline: 0;
}

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] {
    border-bottom: 1px dotted;
}

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong {
    font-weight: bold;
}

/** Address styling not present in Safari 5 and Chrome. */
dfn {
    font-style: italic;
}

/** Address differences between Firefox and other browsers. */
hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/** Address styling not present in IE 8/9. */
mark {
    background: #ff0;
    color: #000;
}

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp {
    font-family: monospace, serif;
    font-size: 1em;
}

/** Improve readability of pre-formatted text in all browsers. */
pre {
    white-space: pre-wrap;
}

/** Set consistent quote types. */
q {
    quotes: "\201C" "\201D" "\2018" "\2019";
}

/** Address inconsistent and variable font size in all browsers. */
small {
    font-size: 80%;
}

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img {
    border: 0;
}

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) {
    overflow: hidden;
}

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure {
    margin: 0;
}

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend {
    border: 0; /* 1 */
    padding: 0; /* 2 */
}

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea {
    font-family: inherit; /* 1 */
    font-size: 100%; /* 2 */
    margin: 0; /* 3 */
}

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input {
    line-height: normal;
}

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select {
    text-transform: none;
}

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
}

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] {
    cursor: default;
}

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
}

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table {
    border-collapse: collapse;
    border-spacing: 0;
}

meta.foundation-mq-small {
    font-family: "only screen and (min-width: 768px)";
    width: 768px;
}

meta.foundation-mq-medium {
    font-family: "only screen and (min-width:1280px)";
    width: 1280px;
}

meta.foundation-mq-large {
    font-family: "only screen and (min-width:1440px)";
    width: 1440px;
}

*, *:before, *:after {
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
}

html, body {
    font-size: 100%;
}

body {
    background: white;
    color: rgba(0, 0, 0, 0.8);
    padding: 0;
    margin: 0;
    font-family: "Noto Serif", "DejaVu Serif", serif;
    font-weight: normal;
    font-style: normal;
    line-height: 1;
    position: relative;
    cursor: auto;
}

a:hover {
    cursor: pointer;
}

img, object, embed {
    max-width: 100%;
    height: auto;
}

object, embed {
    height: 100%;
}

img {
    -ms-interpolation-mode: bicubic;
}

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object {
    max-width: none !important;
}

.left {
    float: left !important;
}

.right {
    float: right !important;
}

.text-left {
    text-align: left !important;
}

.text-right {
    text-align: right !important;
}

.text-center {
    text-align: center !important;
}

.text-justify {
    text-align: justify !important;
}

.hide {
    display: none;
}

.antialiased, body {
    -webkit-font-smoothing: antialiased;
}

img {
    display: inline-block;
    vertical-align: middle;
}

textarea {
    height: auto;
    min-height: 50px;
}

select {
    width: 100%;
}

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p {
    font-size: 1.21875em;
    line-height: 1.6;
}

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title {
    line-height: 1.45;
    color: #7a2518;
    font-weight: normal;
    margin-top: 0;
    margin-bottom: 0.25em;
}

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td {
    margin: 0;
    padding: 0;
    direction: ltr;
}

/* Default Link Styles */
a {
    color: #2156a5;
    text-decoration: underline;
    line-height: inherit;
}

a:hover, a:focus {
    color: #1d4b8f;
}

a img {
    border: none;
}

/* Default paragraph styles */
p {
    font-family: inherit;
    font-weight: normal;
    font-size: 1em;
    line-height: 1.6;
    margin-bottom: 1.25em;
    text-rendering: optimizeLegibility;
}

p aside {
    font-size: 0.875em;
    line-height: 1.35;
    font-style: italic;
}

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 {
    font-family: "Open Sans", "DejaVu Sans", sans-serif;
    font-weight: 300;
    font-style: normal;
    color: #ba3925;
    text-rendering: optimizeLegibility;
    margin-top: 1em;
    margin-bottom: 0.5em;
    line-height: 1.0125em;
}

h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small {
    font-size: 60%;
    color: #e99b8f;
    line-height: 0;
}

h1 {
    font-size: 2.125em;
}

h2 {
    font-size: 1.6875em;
}

h3, #toctitle, .sidebarblock > .content > .title {
    font-size: 1.375em;
}

h4 {
    font-size: 1.125em;
}

h5 {
    font-size: 1.125em;
}

h6 {
    font-size: 1em;
}

hr {
    border: solid #ddddd8;
    border-width: 1px 0 0;
    clear: both;
    margin: 1.25em 0 1.1875em;
    height: 0;
}

/* Helpful Typography Defaults */
em, i {
    font-style: italic;
    line-height: inherit;
}

strong, b {
    font-weight: bold;
    line-height: inherit;
}

small {
    font-size: 60%;
    line-height: inherit;
}

code {
    font-family: "Droid Sans Mono", "DejaVu Sans Mono", "Monospace", monospace;
    font-weight: normal;
    color: rgba(0, 0, 0, 0.9);
}

/* Lists */
ul, ol, dl {
    font-size: 1em;
    line-height: 1.6;
    margin-bottom: 1.25em;
    list-style-position: outside;
    font-family: inherit;
}

ul, ol {
    margin-left: 1.5em;
}

ul.no-bullet, ol.no-bullet {
    margin-left: 1.5em;
}

/* Unordered Lists */
ul li ul, ul li ol {
    margin-left: 1.25em;
    margin-bottom: 0;
    font-size: 1em; /* Override nested font-size change */
}

ul.square li ul, ul.circle li ul, ul.disc li ul {
    list-style: inherit;
}

ul.square {
    list-style-type: square;
}

ul.circle {
    list-style-type: circle;
}

ul.disc {
    list-style-type: disc;
}

ul.no-bullet {
    list-style: none;
}

/* Ordered Lists */
ol li ul, ol li ol {
    margin-left: 1.25em;
    margin-bottom: 0;
}

/* Definition Lists */
dl dt {
    margin-bottom: 0.3125em;
    font-weight: bold;
}

dl dd {
    margin-bottom: 1.25em;
}

/* Abbreviations */
abbr, acronym {
    text-transform: uppercase;
    font-size: 90%;
    color: rgba(0, 0, 0, 0.8);
    border-bottom: 1px dotted #dddddd;
    cursor: help;
}

abbr {
    text-transform: none;
}

/* Blockquotes */
blockquote {
    margin: 0 0 1.25em;
    padding: 0.5625em 1.25em 0 1.1875em;
    border-left: 1px solid #dddddd;
}

blockquote cite {
    display: block;
    font-size: 0.9375em;
    color: rgba(0, 0, 0, 0.6);
}

blockquote cite:before {
    content: "\2014 \0020";
}

blockquote cite a, blockquote cite a:visited {
    color: rgba(0, 0, 0, 0.6);
}

blockquote, blockquote p {
    line-height: 1.6;
    color: rgba(0, 0, 0, 0.85);
}

/* Microformats */
.vcard {
    display: inline-block;
    margin: 0 0 1.25em 0;
    border: 1px solid #dddddd;
    padding: 0.625em 0.75em;
}

.vcard li {
    margin: 0;
    display: block;
}

.vcard .fn {
    font-weight: bold;
    font-size: 0.9375em;
}

.vevent .summary {
    font-weight: bold;
}

.vevent abbr {
    cursor: auto;
    text-decoration: none;
    font-weight: bold;
    border: none;
    padding: 0 0.0625em;
}

@media only screen and (min-width: 768px) {
    h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 {
        line-height: 1.2;
    }

    h1 {
        font-size: 2.75em;
    }

    h2 {
        font-size: 2.3125em;
    }

    h3, #toctitle, .sidebarblock > .content > .title {
        font-size: 1.6875em;
    }

    h4 {
        font-size: 1.4375em;
    }
}

/* Tables */
table {
    background: white;
    margin-bottom: 1.25em;
    border: solid 1px #dedede;
}

table thead, table tfoot {
    background: #f7f8f7;
    font-weight: bold;
}

table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td {
    padding: 0.5em 0.625em 0.625em;
    font-size: inherit;
    color: rgba(0, 0, 0, 0.8);
    text-align: left;
}

table tr th, table tr td {
    padding: 0.5625em 0.625em;
    font-size: inherit;
    color: rgba(0, 0, 0, 0.8);
}

table tr.even, table tr.alt, table tr:nth-of-type(even) {
    background: #f8f8f7;
}

table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td {
    display: table-cell;
    line-height: 1.6;
}

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 {
    line-height: 1.2;
    word-spacing: -0.05em;
}

h1 strong, h2 strong, h3 strong, #toctitle strong, .sidebarblock > .content > .title strong, h4 strong, h5 strong, h6 strong {
    font-weight: 400;
}

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after {
    content: " ";
    display: table;
}

.clearfix:after, .float-group:after {
    clear: both;
}

*:not(pre) > code {
    font-size: 0.9375em;
    font-style: normal !important;
    letter-spacing: 0;
    padding: 0.1em 0.5ex;
    word-spacing: -0.15em;
    background-color: #f7f7f8;
    -webkit-border-radius: 4px;
    border-radius: 4px;
    line-height: 1.45;
    text-rendering: optimizeSpeed;
}

pre, pre > code {
    line-height: 1.45;
    color: rgba(0, 0, 0, 0.9);
    font-family: "Droid Sans Mono", "DejaVu Sans Mono", "Monospace", monospace;
    font-weight: normal;
    text-rendering: optimizeSpeed;
}

.keyseq {
    color: rgba(51, 51, 51, 0.8);
}

kbd {
    display: inline-block;
    color: rgba(0, 0, 0, 0.8);
    font-size: 0.75em;
    line-height: 1.4;
    background-color: #f7f7f7;
    border: 1px solid #ccc;
    -webkit-border-radius: 3px;
    border-radius: 3px;
    -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset;
    box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset;
    margin: -0.15em 0.15em 0 0.15em;
    padding: 0.2em 0.6em 0.2em 0.5em;
    vertical-align: middle;
    white-space: nowrap;
}

.keyseq kbd:first-child {
    margin-left: 0;
}

.keyseq kbd:last-child {
    margin-right: 0;
}

.menuseq, .menu {
    color: rgba(0, 0, 0, 0.8);
}

b.button:before, b.button:after {
    position: relative;
    top: -1px;
    font-weight: normal;
}

b.button:before {
    content: "[";
    padding: 0 3px 0 2px;
}

b.button:after {
    content: "]";
    padding: 0 2px 0 3px;
}

p a > code:hover {
    color: rgba(0, 0, 0, 0.9);
}

#header, #content, #footnotes, #footer {
    width: 100%;
    margin-left: auto;
    margin-right: auto;
    margin-top: 0;
    margin-bottom: 0;
    max-width: 62.5em;
    *zoom: 1;
    position: relative;
    padding-left: 0.9375em;
    padding-right: 0.9375em;
}

#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after {
    content: " ";
    display: table;
}

#header:after, #content:after, #footnotes:after, #footer:after {
    clear: both;
}

#content {
    margin-top: 1.25em;
}

#content:before {
    content: none;
}

#header > h1:first-child {
    color: rgba(0, 0, 0, 0.85);
    margin-top: 2.25rem;
    margin-bottom: 0;
}

#header > h1:first-child + #toc {
    margin-top: 8px;
    border-top: 1px solid #ddddd8;
}

#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) {
    border-bottom: 1px solid #ddddd8;
    padding-bottom: 8px;
}

#header .details {
    border-bottom: 1px solid #ddddd8;
    line-height: 1.45;
    padding-top: 0.25em;
    padding-bottom: 0.25em;
    padding-left: 0.25em;
    color: rgba(0, 0, 0, 0.6);
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;
    -ms-flex-flow: row wrap;
    -webkit-flex-flow: row wrap;
    flex-flow: row wrap;
}

#header .details span:first-child {
    margin-left: -0.125em;
}

#header .details span.email a {
    color: rgba(0, 0, 0, 0.85);
}

#header .details br {
    display: none;
}

#header .details br + span:before {
    content: "\00a0\2013\00a0";
}

#header .details br + span.author:before {
    content: "\00a0\22c5\00a0";
    color: rgba(0, 0, 0, 0.85);
}

#header .details br + span#revremark:before {
    content: "\00a0|\00a0";
}

#header #revnumber {
    text-transform: capitalize;
}

#header #revnumber:after {
    content: "\00a0";
}

#content > h1:first-child:not([class]) {
    color: rgba(0, 0, 0, 0.85);
    border-bottom: 1px solid #ddddd8;
    padding-bottom: 8px;
    margin-top: 0;
    padding-top: 1rem;
    margin-bottom: 1.25rem;
}

#toc {
    border-bottom: 1px solid #efefed;
    padding-bottom: 0.5em;
}

#toc > ul {
    margin-left: 0.125em;
}

#toc ul.sectlevel0 > li > a {
    font-style: italic;
}

#toc ul.sectlevel0 ul.sectlevel1 {
    margin: 0.5em 0;
}

#toc ul {
    font-family: "Open Sans", "DejaVu Sans", sans-serif;
    list-style-type: none;
}

#toc a {
    text-decoration: none;
}

#toc a:active {
    text-decoration: underline;
}

#toctitle {
    color: #7a2518;
    font-size: 1.2em;
}

@media only screen and (min-width: 768px) {
    #toctitle {
        font-size: 1.375em;
    }

    body.toc2 {
        padding-left: 15em;
        padding-right: 0;
    }

    #toc.toc2 {
        margin-top: 0 !important;
        background-color: #f8f8f7;
        position: fixed;
        width: 15em;
        left: 0;
        top: 0;
        border-right: 1px solid #efefed;
        border-top-width: 0 !important;
        border-bottom-width: 0 !important;
        z-index: 1000;
        padding: 1.25em 1em;
        height: 100%;
        overflow: auto;
    }

    #toc.toc2 #toctitle {
        margin-top: 0;
        font-size: 1.2em;
    }

    #toc.toc2 > ul {
        font-size: 0.9em;
        margin-bottom: 0;
    }

    #toc.toc2 ul ul {
        margin-left: 0;
        padding-left: 1em;
    }

    #toc.toc2 ul.sectlevel0 ul.sectlevel1 {
        padding-left: 0;
        margin-top: 0.5em;
        margin-bottom: 0.5em;
    }

    body.toc2.toc-right {
        padding-left: 0;
        padding-right: 15em;
    }

    body.toc2.toc-right #toc.toc2 {
        border-right-width: 0;
        border-left: 1px solid #efefed;
        left: auto;
        right: 0;
    }
}

@media only screen and (min-width: 1280px) {
    body.toc2 {
        padding-left: 20em;
        padding-right: 0;
    }

    #toc.toc2 {
        width: 20em;
    }

    #toc.toc2 #toctitle {
        font-size: 1.375em;
    }

    #toc.toc2 > ul {
        font-size: 0.95em;
    }

    #toc.toc2 ul ul {
        padding-left: 1.25em;
    }

    body.toc2.toc-right {
        padding-left: 0;
        padding-right: 20em;
    }
}

#content #toc {
    border-style: solid;
    border-width: 1px;
    border-color: #e0e0dc;
    margin-bottom: 1.25em;
    padding: 1.25em;
    background: #f8f8f7;
    -webkit-border-radius: 4px;
    border-radius: 4px;
}

#content #toc > :first-child {
    margin-top: 0;
}

#content #toc > :last-child {
    margin-bottom: 0;
}

#footer {
    max-width: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    padding: 1.25em;
}

#footer-text {
    color: rgba(255, 255, 255, 0.8);
    line-height: 1.44;
}

.sect1 {
    padding-bottom: 0.625em;
}

@media only screen and (min-width: 768px) {
    .sect1 {
        padding-bottom: 1.25em;
    }
}

.sect1 + .sect1 {
    border-top: 1px solid #efefed;
}

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor {
    position: absolute;
    z-index: 1001;
    width: 1.5ex;
    margin-left: -1.5ex;
    display: block;
    text-decoration: none !important;
    visibility: hidden;
    text-align: center;
    font-weight: normal;
}

#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before {
    content: "\00A7";
    font-size: 0.85em;
    display: block;
    padding-top: 0.1em;
}

#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover {
    visibility: visible;
}

#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link {
    color: #ba3925;
    text-decoration: none;
}

#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover {
    color: #a53221;
}

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock {
    margin-bottom: 1.25em;
}

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title {
    text-rendering: optimizeLegibility;
    text-align: left;
    font-family: "Noto Serif", "DejaVu Serif", serif;
    font-size: 1rem;
    font-style: italic;
}

table.tableblock > caption.title {
    white-space: nowrap;
    overflow: visible;
    max-width: 0;
}

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p {
    color: rgba(0, 0, 0, 0.85);
}

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p {
    font-size: inherit;
}

.admonitionblock > table {
    border-collapse: separate;
    border: 0;
    background: none;
    width: 100%;
}

.admonitionblock > table td.icon {
    text-align: center;
    width: 80px;
}

.admonitionblock > table td.icon img {
    max-width: none;
}

.admonitionblock > table td.icon .title {
    font-weight: bold;
    font-family: "Open Sans", "DejaVu Sans", sans-serif;
    text-transform: uppercase;
}

.admonitionblock > table td.content {
    padding-left: 1.125em;
    padding-right: 1.25em;
    border-left: 1px solid #ddddd8;
    color: rgba(0, 0, 0, 0.6);
}

.admonitionblock > table td.content > :last-child > :last-child {
    margin-bottom: 0;
}

.exampleblock > .content {
    border-style: solid;
    border-width: 1px;
    border-color: #e6e6e6;
    margin-bottom: 1.25em;
    padding: 1.25em;
    background: white;
    -webkit-border-radius: 4px;
    border-radius: 4px;
}

.exampleblock > .content > :first-child {
    margin-top: 0;
}

.exampleblock > .content > :last-child {
    margin-bottom: 0;
}

.sidebarblock {
    border-style: solid;
    border-width: 1px;
    border-color: #e0e0dc;
    margin-bottom: 1.25em;
    padding: 1.25em;
    background: #f8f8f7;
    -webkit-border-radius: 4px;
    border-radius: 4px;
}

.sidebarblock > :first-child {
    margin-top: 0;
}

.sidebarblock > :last-child {
    margin-bottom: 0;
}

.sidebarblock > .content > .title {
    color: #7a2518;
    margin-top: 0;
    text-align: center;
}

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child {
    margin-bottom: 0;
}

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint {
    background: #f7f7f8;
}

.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint {
    background: #f2f1f1;
}

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] {
    -webkit-border-radius: 4px;
    border-radius: 4px;
    word-wrap: break-word;
    padding: 1em;
    font-size: 0.8125em;
}

.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap {
    overflow-x: auto;
    white-space: pre;
    word-wrap: normal;
}

@media only screen and (min-width: 768px) {
    .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] {
        font-size: 0.90625em;
    }
}

@media only screen and (min-width: 1280px) {
    .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] {
        font-size: 1em;
    }
}

.literalblock.output pre {
    color: #f7f7f8;
    background-color: rgba(0, 0, 0, 0.9);
}

.listingblock pre.highlightjs {
    padding: 0;
}

.listingblock pre.highlightjs > code {
    padding: 1em;
    -webkit-border-radius: 4px;
    border-radius: 4px;
}

.listingblock pre.prettyprint {
    border-width: 0;
}

.listingblock > .content {
    position: relative;
}

.listingblock code[data-lang]:before {
    display: none;
    content: attr(data-lang);
    position: absolute;
    font-size: 0.75em;
    top: 0.425rem;
    right: 0.5rem;
    line-height: 1;
    text-transform: uppercase;
    color: #999;
}

.listingblock:hover code[data-lang]:before {
    display: block;
}

.listingblock.terminal pre .command:before {
    content: attr(data-prompt);
    padding-right: 0.5em;
    color: #999;
}

.listingblock.terminal pre .command:not([data-prompt]):before {
    content: "$";
}

table.pyhltable {
    border-collapse: separate;
    border: 0;
    margin-bottom: 0;
    background: none;
}

table.pyhltable td {
    vertical-align: top;
    padding-top: 0;
    padding-bottom: 0;
}

table.pyhltable td.code {
    padding-left: .75em;
    padding-right: 0;
}

pre.pygments .lineno, table.pyhltable td:not(.code) {
    color: #999;
    padding-left: 0;
    padding-right: .5em;
    border-right: 1px solid #ddddd8;
}

pre.pygments .lineno {
    display: inline-block;
    margin-right: .25em;
}

table.pyhltable .linenodiv {
    background: none !important;
    padding-right: 0 !important;
}

.quoteblock {
    margin: 0 1em 1.25em 1.5em;
    display: table;
}

.quoteblock > .title {
    margin-left: -1.5em;
    margin-bottom: 0.75em;
}

.quoteblock blockquote, .quoteblock blockquote p {
    color: rgba(0, 0, 0, 0.85);
    font-size: 1.15rem;
    line-height: 1.75;
    word-spacing: 0.1em;
    letter-spacing: 0;
    font-style: italic;
    text-align: justify;
}

.quoteblock blockquote {
    margin: 0;
    padding: 0;
    border: 0;
}

.quoteblock blockquote:before {
    content: "\201c";
    float: left;
    font-size: 2.75em;
    font-weight: bold;
    line-height: 0.6em;
    margin-left: -0.6em;
    color: #7a2518;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.quoteblock blockquote > .paragraph:last-child p {
    margin-bottom: 0;
}

.quoteblock .attribution {
    margin-top: 0.5em;
    margin-right: 0.5ex;
    text-align: right;
}

.quoteblock .quoteblock {
    margin-left: 0;
    margin-right: 0;
    padding: 0.5em 0;
    border-left: 3px solid rgba(0, 0, 0, 0.6);
}

.quoteblock .quoteblock blockquote {
    padding: 0 0 0 0.75em;
}

.quoteblock .quoteblock blockquote:before {
    display: none;
}

.verseblock {
    margin: 0 1em 1.25em 1em;
}

.verseblock pre {
    font-family: "Open Sans", "DejaVu Sans", sans;
    font-size: 1.15rem;
    color: rgba(0, 0, 0, 0.85);
    font-weight: 300;
    text-rendering: optimizeLegibility;
}

.verseblock pre strong {
    font-weight: 400;
}

.verseblock .attribution {
    margin-top: 1.25rem;
    margin-left: 0.5ex;
}

.quoteblock .attribution, .verseblock .attribution {
    font-size: 0.9375em;
    line-height: 1.45;
    font-style: italic;
}

.quoteblock .attribution br, .verseblock .attribution br {
    display: none;
}

.quoteblock .attribution cite, .verseblock .attribution cite {
    display: block;
    letter-spacing: -0.05em;
    color: rgba(0, 0, 0, 0.6);
}

.quoteblock.abstract {
    margin: 0 0 1.25em 0;
    display: block;
}

.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p {
    text-align: left;
    word-spacing: 0;
}

.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before {
    display: none;
}

table.tableblock {
    max-width: 100%;
    border-collapse: separate;
}

table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child {
    margin-bottom: 0;
}

table.spread {
    width: 100%;
}

table.tableblock, th.tableblock, td.tableblock {
    border: 0 solid #dedede;
}

table.grid-all th.tableblock, table.grid-all td.tableblock {
    border-width: 0 1px 1px 0;
}

table.grid-all tfoot > tr > th.tableblock, table.grid-all tfoot > tr > td.tableblock {
    border-width: 1px 1px 0 0;
}

table.grid-cols th.tableblock, table.grid-cols td.tableblock {
    border-width: 0 1px 0 0;
}

table.grid-all * > tr > .tableblock:last-child, table.grid-cols * > tr > .tableblock:last-child {
    border-right-width: 0;
}

table.grid-rows th.tableblock, table.grid-rows td.tableblock {
    border-width: 0 0 1px 0;
}

table.grid-all tbody > tr:last-child > th.tableblock, table.grid-all tbody > tr:last-child > td.tableblock, table.grid-all thead:last-child > tr > th.tableblock, table.grid-rows tbody > tr:last-child > th.tableblock, table.grid-rows tbody > tr:last-child > td.tableblock, table.grid-rows thead:last-child > tr > th.tableblock {
    border-bottom-width: 0;
}

table.grid-rows tfoot > tr > th.tableblock, table.grid-rows tfoot > tr > td.tableblock {
    border-width: 1px 0 0 0;
}

table.frame-all {
    border-width: 1px;
}

table.frame-sides {
    border-width: 0 1px;
}

table.frame-topbot {
    border-width: 1px 0;
}

th.halign-left, td.halign-left {
    text-align: left;
}

th.halign-right, td.halign-right {
    text-align: right;
}

th.halign-center, td.halign-center {
    text-align: center;
}

th.valign-top, td.valign-top {
    vertical-align: top;
}

th.valign-bottom, td.valign-bottom {
    vertical-align: bottom;
}

th.valign-middle, td.valign-middle {
    vertical-align: middle;
}

table thead th, table tfoot th {
    font-weight: bold;
}

tbody tr th {
    display: table-cell;
    line-height: 1.6;
    background: #f7f8f7;
}

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p {
    color: rgba(0, 0, 0, 0.8);
    font-weight: bold;
}

p.tableblock > code:only-child {
    background: none;
    padding: 0;
}

p.tableblock {
    font-size: 1em;
}

td > div.verse {
    white-space: pre;
}

ol {
    margin-left: 1.75em;
}

ul li ol {
    margin-left: 1.5em;
}

dl dd {
    margin-left: 1.125em;
}

dl dd:last-child, dl dd:last-child > :last-child {
    margin-bottom: 0;
}

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist {
    margin-bottom: 0.625em;
}

ul.unstyled, ol.unnumbered, ul.checklist, ul.none {
    list-style-type: none;
}

ul.unstyled, ol.unnumbered, ul.checklist {
    margin-left: 0.625em;
}

ul.checklist li > p:first-child > .fa-check-square-o:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child {
    margin-right: 0.25em;
}

ul.checklist li > p:first-child > input[type="checkbox"]:first-child {
    position: relative;
    top: 1px;
}

ul.inline {
    margin: 0 auto 0.625em auto;
    margin-left: -1.375em;
    margin-right: 0;
    padding: 0;
    list-style: none;
    overflow: hidden;
}

ul.inline > li {
    list-style: none;
    float: left;
    margin-left: 1.375em;
    display: block;
}

ul.inline > li > * {
    display: block;
}

.unstyled dl dt {
    font-weight: normal;
    font-style: normal;
}

ol.arabic {
    list-style-type: decimal;
}

ol.decimal {
    list-style-type: decimal-leading-zero;
}

ol.loweralpha {
    list-style-type: lower-alpha;
}

ol.upperalpha {
    list-style-type: upper-alpha;
}

ol.lowerroman {
    list-style-type: lower-roman;
}

ol.upperroman {
    list-style-type: upper-roman;
}

ol.lowergreek {
    list-style-type: lower-greek;
}

.hdlist > table, .colist > table {
    border: 0;
    background: none;
}

.hdlist > table > tbody > tr, .colist > table > tbody > tr {
    background: none;
}

td.hdlist1 {
    padding-right: .75em;
    font-weight: bold;
}

td.hdlist1, td.hdlist2 {
    vertical-align: top;
}

.literalblock + .colist, .listingblock + .colist {
    margin-top: -0.5em;
}

.colist > table tr > td:first-of-type {
    padding: 0 0.75em;
    line-height: 1;
}

.colist > table tr > td:last-of-type {
    padding: 0.25em 0;
}

.thumb, .th {
    line-height: 0;
    display: inline-block;
    border: solid 4px white;
    -webkit-box-shadow: 0 0 0 1px #dddddd;
    box-shadow: 0 0 0 1px #dddddd;
}

.imageblock.left, .imageblock[style*="float: left"] {
    margin: 0.25em 0.625em 1.25em 0;
}

.imageblock.right, .imageblock[style*="float: right"] {
    margin: 0.25em 0 1.25em 0.625em;
}

.imageblock > .title {
    margin-bottom: 0;
}

.imageblock.thumb, .imageblock.th {
    border-width: 6px;
}

.imageblock.thumb > .title, .imageblock.th > .title {
    padding: 0 0.125em;
}

.image.left, .image.right {
    margin-top: 0.25em;
    margin-bottom: 0.25em;
    display: inline-block;
    line-height: 0;
}

.image.left {
    margin-right: 0.625em;
}

.image.right {
    margin-left: 0.625em;
}

a.image {
    text-decoration: none;
}

span.footnote, span.footnoteref {
    vertical-align: super;
    font-size: 0.875em;
}

span.footnote a, span.footnoteref a {
    text-decoration: none;
}

span.footnote a:active, span.footnoteref a:active {
    text-decoration: underline;
}

#footnotes {
    padding-top: 0.75em;
    padding-bottom: 0.75em;
    margin-bottom: 0.625em;
}

#footnotes hr {
    width: 20%;
    min-width: 6.25em;
    margin: -.25em 0 .75em 0;
    border-width: 1px 0 0 0;
}

#footnotes .footnote {
    padding: 0 0.375em;
    line-height: 1.3;
    font-size: 0.875em;
    margin-left: 1.2em;
    text-indent: -1.2em;
    margin-bottom: .2em;
}

#footnotes .footnote a:first-of-type {
    font-weight: bold;
    text-decoration: none;
}

#footnotes .footnote:last-of-type {
    margin-bottom: 0;
}

#content #footnotes {
    margin-top: -0.625em;
    margin-bottom: 0;
    padding: 0.75em 0;
}

.gist .file-data > table {
    border: 0;
    background: #fff;
    width: 100%;
    margin-bottom: 0;
}

.gist .file-data > table td.line-data {
    width: 99%;
}

div.unbreakable {
    page-break-inside: avoid;
}

.big {
    font-size: larger;
}

.small {
    font-size: smaller;
}

.underline {
    text-decoration: underline;
}

.overline {
    text-decoration: overline;
}

.line-through {
    text-decoration: line-through;
}

.aqua {
    color: #00bfbf;
}

.aqua-background {
    background-color: #00fafa;
}

.black {
    color: black;
}

.black-background {
    background-color: black;
}

.blue {
    color: #0000bf;
}

.blue-background {
    background-color: #0000fa;
}

.fuchsia {
    color: #bf00bf;
}

.fuchsia-background {
    background-color: #fa00fa;
}

.gray {
    color: #606060;
}

.gray-background {
    background-color: #7d7d7d;
}

.green {
    color: #006000;
}

.green-background {
    background-color: #007d00;
}

.lime {
    color: #00bf00;
}

.lime-background {
    background-color: #00fa00;
}

.maroon {
    color: #600000;
}

.maroon-background {
    background-color: #7d0000;
}

.navy {
    color: #000060;
}

.navy-background {
    background-color: #00007d;
}

.olive {
    color: #606000;
}

.olive-background {
    background-color: #7d7d00;
}

.purple {
    color: #600060;
}

.purple-background {
    background-color: #7d007d;
}

.red {
    color: #bf0000;
}

.red-background {
    background-color: #fa0000;
}

.silver {
    color: #909090;
}

.silver-background {
    background-color: #bcbcbc;
}

.teal {
    color: #006060;
}

.teal-background {
    background-color: #007d7d;
}

.white {
    color: #bfbfbf;
}

.white-background {
    background-color: #fafafa;
}

.yellow {
    color: #bfbf00;
}

.yellow-background {
    background-color: #fafa00;
}

span.icon > .fa {
    cursor: default;
}

.admonitionblock td.icon [class^="fa icon-"] {
    font-size: 2.5em;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    cursor: default;
}

.admonitionblock td.icon .icon-note:before {
    content: "\f05a";
    color: #19407c;
}

.admonitionblock td.icon .icon-tip:before {
    content: "\f0eb";
    text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8);
    color: #111;
}

.admonitionblock td.icon .icon-warning:before {
    content: "\f071";
    color: #bf6900;
}

.admonitionblock td.icon .icon-caution:before {
    content: "\f06d";
    color: #bf3400;
}

.admonitionblock td.icon .icon-important:before {
    content: "\f06a";
    color: #bf0000;
}

.conum[data-value] {
    display: inline-block;
    color: #fff !important;
    background-color: rgba(0, 0, 0, 0.8);
    -webkit-border-radius: 100px;
    border-radius: 100px;
    text-align: center;
    font-size: 0.75em;
    width: 1.67em;
    height: 1.67em;
    line-height: 1.67em;
    font-family: "Open Sans", "DejaVu Sans", sans-serif;
    font-style: normal;
    font-weight: bold;
}

.conum[data-value] * {
    color: #fff !important;
}

.conum[data-value] + b {
    display: none;
}

.conum[data-value]:after {
    content: attr(data-value);
}

pre .conum[data-value] {
    position: relative;
    top: -0.125em;
}

b.conum * {
    color: inherit !important;
}

.conum:not([data-value]):empty {
    display: none;
}

h1, h2 {
    letter-spacing: -0.01em;
}

dt, th.tableblock, td.content {
    text-rendering: optimizeLegibility;
}

p, td.content {
    letter-spacing: -0.01em;
}

p strong, td.content strong {
    letter-spacing: -0.005em;
}

p, blockquote, dt, td.content {
    font-size: 1.0625rem;
}

p {
    margin-bottom: 1.25rem;
}

.sidebarblock p, .sidebarblock dt, .sidebarblock td.content, p.tableblock {
    font-size: 1em;
}

.exampleblock > .content {
    background-color: #fffef7;
    border-color: #e0e0dc;
    -webkit-box-shadow: 0 1px 4px #e0e0dc;
    box-shadow: 0 1px 4px #e0e0dc;
}

.print-only {
    display: none !important;
}

@media print {
    @page {
        margin: 1.25cm 0.75cm;
    }

    * {
        -webkit-box-shadow: none !important;
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a {
        color: inherit !important;
        text-decoration: underline !important;
    }

    a.bare, a[href^="#"], a[href^="mailto:"] {
        text-decoration: none !important;
    }

    a[href^="http:"]:not(.bare):after, a[href^="https:"]:not(.bare):after, a[href^="mailto:"]:not(.bare):after {
        content: "(" attr(href) ")";
        display: inline-block;
        font-size: 0.875em;
        padding-left: 0.25em;
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    pre, blockquote, tr, img {
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group;
    }

    img {
        max-width: 100% !important;
    }

    p, blockquote, dt, td.content {
        font-size: 1em;
        orphans: 3;
        widows: 3;
    }

    h2, h3, #toctitle, .sidebarblock > .content > .title, #toctitle, .sidebarblock > .content > .title {
        page-break-after: avoid;
    }

    #toc, .sidebarblock, .exampleblock > .content {
        background: none !important;
    }

    #toc {
        border-bottom: 1px solid #ddddd8 !important;
        padding-bottom: 0 !important;
    }

    .sect1 {
        padding-bottom: 0 !important;
    }

    .sect1 + .sect1 {
        border: 0 !important;
    }

    #header > h1:first-child {
        margin-top: 1.25rem;
    }

    body.book #header {
        text-align: center;
    }

    body.book #header > h1:first-child {
        border: 0 !important;
        margin: 2.5em 0 1em 0;
    }

    body.book #header .details {
        border: 0 !important;
        display: block;
        padding: 0 !important;
    }

    body.book #header .details span:first-child {
        margin-left: 0 !important;
    }

    body.book #header .details br {
        display: block;
    }

    body.book #header .details br + span:before {
        content: none !important;
    }

    body.book #toc {
        border: 0 !important;
        text-align: left !important;
        padding: 0 !important;
        margin: 0 !important;
    }

    body.book #toc, body.book #preamble, body.book h1.sect0, body.book .sect1 > h2 {
        page-break-before: always;
    }

    .listingblock code[data-lang]:before {
        display: block;
    }

    #footer {
        background: none !important;
        padding: 0 0.9375em;
    }

    #footer-text {
        color: rgba(0, 0, 0, 0.6) !important;
        font-size: 0.9em;
    }

    .hide-on-print {
        display: none !important;
    }

    .print-only {
        display: block !important;
    }

    .hide-for-print {
        display: none !important;
    }

    .show-for-print {
        display: inherit !important;
    }
}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>EZ-Framework(EZ.F) Document</h1>
<div class="details">
<span id="author" class="author">gudaoxuri</span><br>
<span id="revnumber">version 3.0.0</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#trueez-f-scala">EZ.F - Scala中功能全面、使用简单的服务框架</a>
<ul class="sectlevel1">
<li><a href="#true-">1. 设计理念</a></li>
<li><a href="#true--2">2. 功能列表</a></li>
<li><a href="#true--3">3. 使用</a></li>
<li><a href="#true--4">4. 文档</a></li>
<li><a href="#truelicense">5. License</a></li>
<li><a href="#true--5">6. 持久化服务</a>
<ul class="sectlevel2">
<li><a href="#true--6">6.1. 功能</a></li>
<li><a href="#true5">6.2. 5分钟上手</a></li>
<li><a href="#true--7">6.3. 依赖</a></li>
<li><a href="#truemongo">6.4. Mongo配置</a></li>
<li><a href="#truejdbc">6.5. JDBC配置</a></li>
<li><a href="#true--8">6.6. 使用</a>
<ul class="sectlevel3">
<li><a href="#true--9">6.6.1. 注解及方法定义</a></li>
<li><a href="#true--10">6.6.2. 常用方法</a></li>
<li><a href="#true--11">6.6.3. 适配器使用</a></li>
<li><a href="#truemongo-api">6.6.4. Mongo低层API使用</a></li>
<li><a href="#truemongo-api-2">6.6.5. Mongo低层API使用</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#truerpc">7. RPC服务</a>
<ul class="sectlevel2">
<li><a href="#true--16">7.1. 功能</a></li>
<li><a href="#true5-2">7.2. 5分钟上手</a></li>
<li><a href="#true--17">7.3. 依赖</a></li>
<li><a href="#truehttp">7.4. HTTP配置</a></li>
<li><a href="#truewebsocket">7.5. WebSocket配置</a></li>
<li><a href="#true--18">7.6. 使用</a>
<ul class="sectlevel3">
<li><a href="#truehttp-2">7.6.1. HTTP服务注解及方法定义</a></li>
<li><a href="#truewebsocket-2">7.6.2. WebSocket服务注解及方法定义</a></li>
<li><a href="#truesimplehttpservice">7.6.3. SimpleHttpService脚手架</a></li>
<li><a href="#truehttp-3">7.6.4. HTTP客户端</a></li>
<li><a href="#truewebsocket-3">7.6.5. WebSocket消息推送管理</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#true--21">8. 认证服务</a>
<ul class="sectlevel2">
<li><a href="#true--22">8.1. 功能</a></li>
<li><a href="#true5-3">8.2. 5分钟上手</a></li>
<li><a href="#true--23">8.3. 依赖</a></li>
<li><a href="#true--24">8.4. 配置</a></li>
<li><a href="#true--25">8.5. 认证服务接入</a></li>
<li><a href="#true--26">8.6. 预定义认证接口调用</a>
<ul class="sectlevel3">
<li><a href="#true--27">8.6.1. 说明</a></li>
<li><a href="#true--28">8.6.2. 登录</a></li>
<li><a href="#true--29">8.6.3. 注销</a></li>
<li><a href="#true--30">8.6.4. 获取登录信息</a></li>
<li><a href="#true--31">8.6.5. 获取菜单（带权限过滤）</a></li>
<li><a href="#true--32">8.6.6. 注册</a></li>
<li><a href="#true--33">8.6.7. 激活账号</a></li>
<li><a href="#true--34">8.6.8. 找回（重置）密码</a></li>
<li><a href="#true--35">8.6.9. 激活新密码</a></li>
<li><a href="#true--36">8.6.10. 获取登录账号信息</a></li>
<li><a href="#true--37">8.6.11. 更新登录账号信息</a></li>
<li><a href="#true--38">8.6.12. （管理接口）添加资源</a></li>
<li><a href="#true--39">8.6.13. （管理接口）更新资源</a></li>
<li><a href="#true--40">8.6.14. （管理接口）查找资源列表</a></li>
<li><a href="#true--41">8.6.15. （管理接口）查找启用资源列表</a></li>
<li><a href="#true--42">8.6.16. （管理接口）分页查找资源列表</a></li>
<li><a href="#true--43">8.6.17. （管理接口）获取一个资源</a></li>
<li><a href="#true--44">8.6.18. （管理接口）删除一个资源</a></li>
<li><a href="#true--45">8.6.19. （管理接口）启用一个资源</a></li>
<li><a href="#true--46">8.6.20. （管理接口）禁用一个资源</a></li>
<li><a href="#true--47">8.6.21. （管理接口）导出资源列表</a></li>
<li><a href="#true--48">8.6.22. （管理接口）添加组织</a></li>
<li><a href="#true--49">8.6.23. （管理接口）更新组织</a></li>
<li><a href="#true--50">8.6.24. （管理接口）查找组织列表</a></li>
<li><a href="#true--51">8.6.25. （管理接口）查找启用组织列表</a></li>
<li><a href="#true--52">8.6.26. （管理接口）分页查找组织列表</a></li>
<li><a href="#true--53">8.6.27. （管理接口）获取一个组织</a></li>
<li><a href="#true--54">8.6.28. （管理接口）删除一个组织</a></li>
<li><a href="#true--55">8.6.29. （管理接口）启用一个组织</a></li>
<li><a href="#true--56">8.6.30. （管理接口）禁用一个组织</a></li>
<li><a href="#true--57">8.6.31. （管理接口）导出组织列表</a></li>
<li><a href="#true--58">8.6.32. （管理接口）上传组织图标</a></li>
<li><a href="#true--59">8.6.33. （管理接口）获取组织图标</a></li>
<li><a href="#true--60">8.6.34. （管理接口）添加角色</a></li>
<li><a href="#true--61">8.6.35. （管理接口）更新角色</a></li>
<li><a href="#true--62">8.6.36. （管理接口）查找角色列表</a></li>
<li><a href="#true--63">8.6.37. （管理接口）查找启用角色列表</a></li>
<li><a href="#true--64">8.6.38. （管理接口）分页查找角色列表</a></li>
<li><a href="#true--65">8.6.39. （管理接口）获取一个角色</a></li>
<li><a href="#true--66">8.6.40. （管理接口）删除一个角色</a></li>
<li><a href="#true--67">8.6.41. （管理接口）启用一个角色</a></li>
<li><a href="#true--68">8.6.42. （管理接口）禁用一个角色</a></li>
<li><a href="#true--69">8.6.43. （管理接口）导出角色列表</a></li>
<li><a href="#true--70">8.6.44. （管理接口）添加账户</a></li>
<li><a href="#true--71">8.6.45. （管理接口）更新账户</a></li>
<li><a href="#true--72">8.6.46. （管理接口）查找账户列表</a></li>
<li><a href="#true--73">8.6.47. （管理接口）查找启用账户列表</a></li>
<li><a href="#true--74">8.6.48. （管理接口）分页查找账户列表</a></li>
<li><a href="#true--75">8.6.49. （管理接口）获取一个账户</a></li>
<li><a href="#true--76">8.6.50. （管理接口）删除一个账户</a></li>
<li><a href="#true--77">8.6.51. （管理接口）启用一个账户</a></li>
<li><a href="#true--78">8.6.52. （管理接口）禁用一个账户</a></li>
<li><a href="#true--79">8.6.53. （管理接口）导出账户列表</a></li>
<li><a href="#true--80">8.6.54. （管理接口）上传账户头像</a></li>
<li><a href="#true--81">8.6.55. （管理接口）获取账户头像</a></li>
<li><a href="#true--82">8.6.56. （管理接口）添加菜单</a></li>
<li><a href="#true--83">8.6.57. （管理接口）更新菜单</a></li>
<li><a href="#true--84">8.6.58. （管理接口）查找菜单列表</a></li>
<li><a href="#true--85">8.6.59. （管理接口）查找启用菜单列表</a></li>
<li><a href="#true--86">8.6.60. （管理接口）分页查找菜单列表</a></li>
<li><a href="#true--87">8.6.61. （管理接口）获取一个菜单</a></li>
<li><a href="#true--88">8.6.62. （管理接口）删除一个菜单</a></li>
<li><a href="#true--89">8.6.63. （管理接口）启用一个菜单</a></li>
<li><a href="#true--90">8.6.64. （管理接口）禁用一个菜单</a></li>
<li><a href="#true--91">8.6.65. （管理接口）导出菜单列表</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#true--92">9. 邮件服务</a>
<ul class="sectlevel2">
<li><a href="#true--93">9.1. 功能</a></li>
<li><a href="#true5-4">9.2. 5分钟上手</a></li>
<li><a href="#true--94">9.3. 依赖</a></li>
<li><a href="#true--95">9.4. 配置</a>
<ul class="sectlevel3">
<li><a href="#trueqq">9.4.1. QQ企业邮箱配置示例</a></li>
</ul>
</li>
<li><a href="#true--96">9.5. 使用</a>
<ul class="sectlevel3">
<li><a href="#true--97">9.5.1. 同步操作</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#trueredis">10. Redis服务</a>
<ul class="sectlevel2">
<li><a href="#true--99">10.1. 功能</a></li>
<li><a href="#true5-5">10.2. 5分钟上手</a></li>
<li><a href="#true--100">10.3. 依赖</a></li>
<li><a href="#true--101">10.4. 配置</a></li>
<li><a href="#true--102">10.5. 使用</a>
<ul class="sectlevel3">
<li><a href="#true--103">10.5.1. 同步操作</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#true--105">11. 常用分布式服务</a>
<ul class="sectlevel2">
<li><a href="#true--106">11.1. 功能</a></li>
<li><a href="#true5-6">11.2. 5分钟上手</a></li>
<li><a href="#true--107">11.3. 依赖</a></li>
<li><a href="#true--108">11.4. 配置</a></li>
<li><a href="#true--109">11.5. 使用</a>
<ul class="sectlevel3">
<li><a href="#true-atomiclong">11.5.1. 分布式AtomicLong</a></li>
<li><a href="#true--110">11.5.2. 分布式阻塞队列</a></li>
<li><a href="#true-countdownlatch">11.5.3. 分布式CountDownLatch</a></li>
<li><a href="#true--111">11.5.4. 分布式原子计数器</a></li>
<li><a href="#true--112">11.5.5. 分布式锁</a></li>
<li><a href="#true-map-key-string-value">11.5.6. 分布式Map，key为string , value为自定义类型</a></li>
<li><a href="#true--113">11.5.7. 分布式队列（不阻塞）</a></li>
<li><a href="#true--114">11.5.8. 分布式消息队列</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#true--115">12. 调度服务</a>
<ul class="sectlevel2">
<li><a href="#true--116">12.1. 功能</a></li>
<li><a href="#true5-7">12.2. 5分钟上手</a></li>
<li><a href="#true--117">12.3. 依赖</a></li>
<li><a href="#true--118">12.4. 配置</a></li>
<li><a href="#true--119">12.5. 使用</a></li>
</ul>
</li>
<li><a href="#truekafka">13. Kafka服务</a>
<ul class="sectlevel2">
<li><a href="#true--120">13.1. 功能</a></li>
<li><a href="#true5-8">13.2. 5分钟上手</a></li>
<li><a href="#true--121">13.3. 依赖</a></li>
<li><a href="#true--122">13.4. 配置</a></li>
<li><a href="#true--123">13.5. 使用</a></li>
<li><a href="#trueapi">13.6. API</a></li>
</ul>
</li>
<li><a href="#truemaster-slave">14. Master-Slave服务</a>
<ul class="sectlevel2">
<li><a href="#true--124">14.1. 功能</a></li>
<li><a href="#true5-9">14.2. 5分钟上手</a></li>
<li><a href="#true--125">14.3. 依赖</a></li>
<li><a href="#true--126">14.4. 配置</a></li>
<li><a href="#true--127">14.5. 使用</a></li>
<li><a href="#trueapi-2">14.6. API</a></li>
</ul>
</li>
<li><a href="#truecontributing">15. Contributing</a>
<ul class="sectlevel3">
<li><a href="#trueenvironment">15.1. Environment</a></li>
<li><a href="#truebuild">15.2. Build</a></li>
<li><a href="#truesubmit">15.3. Submit</a></li>
</ul>
</li>
<li><a href="#trueroadmap">16. Roadmap</a>
<ul class="sectlevel2">
<li><a href="#true3-1-0">16.1. 3.1.0</a></li>
<li><a href="#true3-0-0">16.2. 3.0.0</a></li>
<li><a href="#true3-0-0-snapshot">16.3. 3.0.0-SNAPSHOT</a></li>
</ul>
</li>
<li><a href="#truechangelog">17. ChangeLog</a>
<ul class="sectlevel2">
<li><a href="#true3-0-0-2">17.1. 3.0.0</a>
<ul class="sectlevel3">
<li><a href="#truefeatures">17.1.1. Features</a></li>
<li><a href="#truebug-fixes">17.1.2. Bug Fixes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<h1 id="trueez-f-scala" class="sect0"><a class="anchor" href="#trueez-f-scala"></a>EZ.F - Scala中功能全面、使用简单的服务框架</h1>
<div class="openblock partintro">
<div class="content">
<div class="imageblock">
<div class="content">
<a class="image" href="https://travis-ci.org/gudaoxuri/ez-framework"><img src="https://img.shields.io/travis/gudaoxuri/ez-framework.svg" alt="ez framework.svg"></a>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true-"><a class="anchor" href="#true-"></a>1. 设计理念</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>类库化</strong> 低侵入，虽然以“框架”称呼，但实际上是<strong>多个类库的集合</strong>，这里没有<em>容器</em>，不会与您的工程强耦合</p>
</li>
<li>
<p><strong>模块化</strong> 所有功能按需选择，让您的工程尽可能轻量</p>
</li>
<li>
<p><strong>高性能</strong> 核心模块提供同步与异步两种模型，高性能需求可选择异步模型</p>
</li>
<li>
<p><strong>功能全面</strong> 集成了常用的服务，全栈支持</p>
</li>
<li>
<p><strong>使用简单</strong> 各API都尽可能地统一与简化，降低使用成本</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--2"><a class="anchor" href="#true--2"></a>2. 功能列表</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>RPC服务</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>支持HTTP和WebSocket服务</p>
</li>
<li>
<p>基于注解服务发现</p>
</li>
<li>
<p>Restful风格，支持GET POST PUT DELETE等常用方法</p>
</li>
<li>
<p>支持HTTPS</p>
</li>
<li>
<p>支持Json跨域请求</p>
</li>
<li>
<p>支持拦截器栈，可适配权限认证等服务</p>
</li>
<li>
<p>提供同步及异步HTTP客户端</p>
</li>
<li>
<p>提供CRUD脚手架服务</p>
</li>
<li>
<p>支持HTML与XML处理</p>
</li>
</ol>
</div>
</li>
<li>
<p>存储服务</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>支持Mongo或关系型数据库（JDBC）</p>
</li>
<li>
<p>统一API</p>
</li>
<li>
<p>轻量级ORMapping，无Session处理</p>
</li>
<li>
<p>注解支持</p>
</li>
</ol>
</div>
</li>
<li>
<p>调度服务</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>支持cron表达式的调度任务</p>
</li>
<li>
<p>支持按模块调度</p>
</li>
<li>
<p>支持JDBC或Mongo的持久化</p>
</li>
</ol>
</div>
</li>
<li>
<p>Redis缓存服务</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>支持Redis的常用操作</p>
</li>
<li>
<p>支持同步与异步操作</p>
</li>
</ol>
</div>
</li>
<li>
<p>基于RBAC的基础HTTP认证</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>支持RBAC的认证服务</p>
</li>
<li>
<p>支持菜单级和资源级（action）的授权</p>
</li>
<li>
<p>支持JDBC或Mongo的持久化</p>
</li>
<li>
<p>支持自助注册及密码找回</p>
</li>
</ol>
</div>
</li>
<li>
<p>邮件服务</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>支持同步或异步的邮件发送服务</p>
</li>
<li>
<p>支持添加附件</p>
</li>
</ol>
</div>
</li>
<li>
<p>Kakfa服务</p>
</li>
<li>
<p>Master-Slave服务</p>
</li>
<li>
<p>常用分布式服务</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>分布式计数</p>
</li>
<li>
<p>分布式锁</p>
</li>
<li>
<p>分布式Map</p>
</li>
<li>
<p>分布式阻塞和非阻塞队列</p>
</li>
<li>
<p>分布式消息发布订阅</p>
</li>
</ol>
</div>
</li>
<li>
<p>支持自定义同步或异步的拦截器栈处理</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--3"><a class="anchor" href="#true--3"></a>3. 使用</h2>
<div class="sectionbody">
<div class="paragraph">
<p>通过Maven引用</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml" data-lang="xml">&lt;!-- 核心包 --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.ecfront&lt;/groupId&gt;
    &lt;artifactId&gt;ezf-core&lt;/artifactId&gt;
    &lt;version&gt;3.0.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;
&lt;!-- 各服务模块包 --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.ecfront&lt;/groupId&gt;
    &lt;artifactId&gt;ezf-&lt;服务模块&gt;&lt;/artifactId&gt;
    &lt;version&gt;3.0.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--4"><a class="anchor" href="#true--4"></a>4. 文档</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="http://gudaoxuri.github.io/ez-framework">http://gudaoxuri.github.io/ez-framework</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truelicense"><a class="anchor" href="#truelicense"></a>5. License</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Under version 2.0 of the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--5"><a class="anchor" href="#true--5"></a>6. 持久化服务</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="true--6"><a class="anchor" href="#true--6"></a>6.1. 功能</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>支持Mongo或关系型数据库（JDBC）</p>
</li>
<li>
<p>统一API</p>
</li>
<li>
<p>轻量级ORMapping，无Session处理</p>
</li>
<li>
<p>注解支持</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
关系型数据库目前的测试基于MySQL，其它数据库未做详细测试
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
数据字段应避免使用null值，字符用""、数字用0（或其它）、Bool用false 等代替
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="true5"><a class="anchor" href="#true5"></a>6.2. 5分钟上手</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>添加依赖</p>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
  &lt;groupId&gt;com.ecfront&lt;/groupId&gt;
  &lt;artifactId&gt;ezf-storage-&lt;mongo或jdbc&gt;&lt;/artifactId&gt;
  &lt;version&gt;3.0.0-SNAPSHOT&lt;/version&gt;
&lt;dependency&gt;</pre>
</div>
</div>
</li>
<li>
<p>添加配置</p>
<div class="literalblock">
<div class="content">
<pre>// Mongo
"storage.mongo": {
  "host": "&lt;服务IP&gt;",
  "port": &lt;服务端口&gt;,
  "db_name": "&lt;数据库名&gt;"
}</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>// 或 JDBC
"storage.jdbc": {
  "driver_class": "&lt;驱动&gt;",
  "url": "&lt;连接URL&gt;",
  "user": "&lt;用户名&gt;",
  "password": "&lt;密码&gt;"
}</pre>
</div>
</div>
</li>
<li>
<p>在添加scala类</p>
<div class="literalblock">
<div class="content">
<pre>@Entity("")
case class Test_Entity() extends BaseModel {</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>@Unique
@Label("姓名")
@Require
@BeanProperty var name: String = _</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>}</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>// Mongo
object Mongo_Test_Entity extends MongoBaseStorage[Test_Entity]
//或
object JDBC_Test_Entity extends MongoBaseStorage[Test_Entity]</pre>
</div>
</div>
</li>
<li>
<p>测试服务</p>
<div class="literalblock">
<div class="content">
<pre>EZManager.start()</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>var entity = Test_Entity()
mongo.name = "name1"</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>// 保存并获取持久化后的id
// Mongo
var id = Mongo_Test_Entity.save(mongo).body.id
// 或 JDBC
var id = JDBC_Test_Entity.save(mongo).body.id</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
JDBC方式需要手工创建数据库及数据表
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="true--7"><a class="anchor" href="#true--7"></a>6.3. 依赖</h3>
<div class="paragraph">
<p>环境依赖：mongo或关系型数据库</p>
</div>
</div>
<div class="sect2">
<h3 id="truemongo"><a class="anchor" href="#truemongo"></a>6.4. Mongo配置</h3>
<div class="listingblock">
<div class="content">
<pre>"storage.mongo": {
  // 单个集群设置
  "host" : "", <i class="conum" data-value="1"></i><b>(1)</b>
  "port" : 27017,  <i class="conum" data-value="2"></i><b>(2)</b>

  // 多集群设置
  "hosts" : [
    {
      "host" : "cluster1", <i class="conum" data-value="1"></i><b>(1)</b>
      "port" :  <i class="conum" data-value="2"></i><b>(2)</b>
    },
    {
      "host" : "cluster2", <i class="conum" data-value="1"></i><b>(1)</b>
      "port" :  <i class="conum" data-value="2"></i><b>(2)</b>
    },
    ...
  ],

  db_name: "" <i class="conum" data-value="3"></i><b>(3)</b>

  "replicaSet" :  "" <i class="conum" data-value="4"></i><b>(4)</b>

  // 连接池设置
  "maxPoolSize" : 100, <i class="conum" data-value="5"></i><b>(5)</b>
  "minPoolSize" : 0, <i class="conum" data-value="6"></i><b>(6)</b>
  "maxIdleTimeMS" : 0, <i class="conum" data-value="7"></i><b>(7)</b>
  "maxLifeTimeMS" : 0,  <i class="conum" data-value="8"></i><b>(8)</b>

  // 认证设置
  "username"   : "", <i class="conum" data-value="9"></i><b>(9)</b>
  "password"   : "", <i class="conum" data-value="10"></i><b>(10)</b>

  ...
}</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>服务IP或Host</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>服务端口</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>数据库名</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>复制集的名字</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>最大连接数</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>最小连接数</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>一个连接的最大空闲时间</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>一个连接的最大存活时间</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>用户名</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>密码</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
本服务基于 <code>vertx-mongo-client</code> 实现，更多配置见：http://vertx.io/docs/vertx-mongo-client/java/#_configuring_the_client
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="truejdbc"><a class="anchor" href="#truejdbc"></a>6.5. JDBC配置</h3>
<div class="listingblock">
<div class="content">
<pre>"storage.jdbc": {
 "provider_class":"io.vertx.ext.jdbc.spi.impl.C3P0DataSourceProvider" <i class="conum" data-value="1"></i><b>(1)</b>
 // C3P0 配置
 "driver_class": "",
 "url": "",
 "user": "",
 "password": ""
 ...
}</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>连接池实现类，默认是C3P0，还支持HikariCP（io.vertx.ext.jdbc.spi.impl.HikariCPDataSourceProvider）及BoneCP（io.vertx.ext.jdbc.spi.impl.BoneCPDataSourceProvider）</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
C3P0的配置见 <a href="http://www.mchange.com/projects/c3p0/#configuration" class="bare">http://www.mchange.com/projects/c3p0/#configuration</a>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
HikariCP的配置见 <a href="https://github.com/brettwooldridge/HikariCP#configuration-knobs-baby" class="bare">https://github.com/brettwooldridge/HikariCP#configuration-knobs-baby</a>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
BoneCP的配置见 <a href="http://www.jolbox.com/configuration.html" class="bare">http://www.jolbox.com/configuration.html</a>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
本服务基于 <code>vertx-jdbc-client</code> 实现，更多配置见：http://vertx.io/docs/vertx-jdbc-client/java/#_configuration
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="true--8"><a class="anchor" href="#true--8"></a>6.6. 使用</h3>
<div class="sect3">
<h4 id="true--9"><a class="anchor" href="#true--9"></a>6.6.1. 注解及方法定义</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">// 使用Entity注解表示此类可以持久化（实体）
@Entity("")
// 所有实体都要直接或间接BaseModel，BaseModel添加了名为`id`的字段
// StatusModel在BaseModel的基础上添加了`enable`字段，对于表示状态的启用或禁用
// SecureModel在BaseModel的基础上添加了6个字段，对于记录操作信息：
//    create_user 创建用户
//    create_org 创建组织
//    create_time 创建时间(yyyyMMddHHmmssSSS)
//    update_user 更新用户
//    update_org 更新组织
//    update_time 更新时间(yyyyMMddHHmmssSSS)
case class Test_Entity() extends SecureModel with StatusModel {

  // @Unique 表示唯一性，保存或更新时会做唯一性检查，可选
  @Unique
  // @Require 表示必填，保存或更新时会做为空检查，可选
  @Require
  // @Label 表示字段说明，出错时（不唯一、为空等）用于显示，可选
  @Label("姓名")
  // @BeanProperty 所有要持久化的字段都要加上此注解
  @BeanProperty
  // 字段名称及类型定义
  var name: String = _
  // 字段可以是复杂类型
  @BeanProperty var parameters: Map[String, Any] = _

}

// 以上只是定义了实体，但没有持久化能力，要实现持久化还要添加一个间接继承自BaseStorage[E]的object

// Mongo持久化时要直接或间接继承MongoBaseStorage[E]，E是要持久化的实体
// 与BaseModel一样，Storage也有StatusStorage、SecureStorage及其对应的Mongo和JDBC实现
object Mongo_Test_Entity extends MongoSecureStorage[Test_Entity] with MongoStatusStorage[Test_Entity]

// JDBC持久化时要直接或间接继承JDBCBaseStorage[E]
object JDBC_Test_Entity extends JDBCSecureStorage[Test_Entity] with JDBCStatusStorage[Test_Entity]</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
限制：所有实体都必须有Id字段，对JDBC而言，Id必须是自增类型（INT），对于Mongo而言则是"_id"，映射到实体时Id字段统一用String类型
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
如果持久化字段是复杂类型，MySQL的版本必须是5.7及以上，建表时请用<code>JSON</code>类型
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="true--10"><a class="anchor" href="#true--10"></a>6.6.2. 常用方法</h4>
<div class="listingblock">
<div class="title">继承自（Mongo或JDBC）BaseStorage[E]的方法</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">/**
  * 保存
  *
  * @param model   实体对象
  * @param context 上下文
  * @return 保存后的实体对象
  */
def save(model: M, context: EZStorageContext = EZStorageContext()): Resp[M]
/**
  * 更新
  *
  * @param model   实体对象
  * @param context 上下文
  * @return 更新后的实体对象
  */
def update(model: M, context: EZStorageContext = EZStorageContext()): Resp[M]
/**
  * 保存或更新
  *
  * @param model   实体对象
  * @param context 上下文
  * @return 保存或更新后的实体对象
  */
def saveOrUpdate(model: M, context: EZStorageContext = EZStorageContext()): Resp[M]

/**
  * 更新
  *
  * @param newValues  新值，SQL (相当于SET中的条件)或Json
  * @param condition  条件，SQL (相当于Where中的条件)或Json
  * @param parameters 参数 ，Mongo不需要
  * @param context    上下文
  * @return 是否成功
  */
def updateByCond(newValues: String, condition: String, parameters: List[Any] = List(), context: EZStorageContext = EZStorageContext()): Resp[Void]

/**
  * 删除
  *
  * @param id      主键
  * @param context 上下文
  * @return 是否成功
  */
def deleteById(id: Any, context: EZStorageContext = EZStorageContext()): Resp[Void]

/**
  * 删除
  *
  * @param condition  条件，SQL (相当于Where中的条件)或Json
  * @param parameters 参数 ，Mongo不需要
  * @param context    上下文
  * @return 是否成功
  */
def deleteByCond(condition: String, parameters: List[Any] = List(), context: EZStorageContext = EZStorageContext()): Resp[Void]

/**
  * 获取一条记录
  *
  * @param id      主键
  * @param context 上下文
  * @return 获取到的记录
  */
def getById(id: Any, context: EZStorageContext = EZStorageContext()): Resp[M]

/**
  * 获取一条记录
  *
  * @param condition  条件，SQL (相当于Where中的条件)或Json
  * @param parameters 参数 ，Mongo不需要
  * @param context    上下文
  * @return 获取到的记录
  */
def getByCond(condition: String, parameters: List[Any] = List(), context: EZStorageContext = EZStorageContext()): Resp[M]

/**
  * 判断是否存在
  *
  * @param id      主键
  * @param context 上下文
  * @return 是否存在
  */
def existById(id: Any, context: EZStorageContext = EZStorageContext()): Resp[Boolean]

/**
  * 判断是否存在
  *
  * @param condition  条件，SQL (相当于Where中的条件)或Json
  * @param parameters 参数 ，Mongo不需要
  * @param context    上下文
  * @return 是否存在
  */
def existByCond(condition: String, parameters: List[Any] = List(), context: EZStorageContext = EZStorageContext()): Resp[Boolean]

/**
  * 查找
  *
  * @param condition  条件，SQL (相当于Where中的条件)或Json
  * @param parameters 参数 ，Mongo不需要
  * @param context    上下文
  * @return 查找结果
  */
def find(condition: String, parameters: List[Any] = List(), context: EZStorageContext = EZStorageContext()): Resp[List[M]]

/**
* 分页
*
* @param condition  条件，SQL (相当于Where中的条件)或Json
* @param parameters 参数 ，Mongo不需要
* @param pageNumber 当前页，从1开始
* @param pageSize   每页条数
* @param context    上下文
* @return 分页结果
*/
def page(condition: String, parameters: List[Any] = List(), pageNumber: Long = 1, pageSize: Int = 10,
           context: EZStorageContext = EZStorageContext()): Resp[Page[M]]

/**
  * 计数
  *
  * @param condition  条件，SQL (相当于Where中的条件)或Json
  * @param parameters 参数 ，Mongo不需要
  * @param context    上下文
  * @return 条数
  */
def count(condition: String, parameters: List[Any] = List(), context: EZStorageContext = EZStorageContext()): Resp[Long]</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">继承自（Mongo或JDBC）StatusStorage[E]的方法</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">/**
  * 获取一条启用的记录
  *
  * @param condition  条件，SQL (相当于Where中的条件)或Json
  * @param parameters 参数 ，Mongo不需要
  * @param context    上下文
  * @return 获取到的记录
  */
def getEnabledByCond(condition: String, parameters: List[Any] = List(), context: EZStorageContext = null): Resp[M]

/**
  * 启用记录查找
  *
  * @param condition  条件，SQL (相当于Where中的条件)或Json
  * @param parameters 参数 ，Mongo不需要
  * @param context    上下文
  * @return 查找到的记录
  */
def findEnabled(condition: String, parameters: List[Any] = List(), context: EZStorageContext = null): Resp[List[M]]

/**
  * 启用记录分页
  *
  * @param condition  条件，SQL (相当于Where中的条件)或Json
  * @param parameters 参数 ，Mongo不需要
  * @param pageNumber 当前页，从1开始
  * @param pageSize   每页条数
  * @param context    上下文
  * @return 分页结果
  */
def pageEnabled(
                 condition: String,
                 parameters: List[Any] = List(),
                 pageNumber: Long = 1, pageSize: Int = 10, context: EZStorageContext = null): Resp[Page[M]]

/**
  * 判断启用记录是否存在
  *
  * @param condition  条件，SQL (相当于Where中的条件)或Json
  * @param parameters 参数 ，Mongo不需要
  * @param context    上下文
  * @return 是否存在
  */
def existEnabledByCond(condition: String, parameters: List[Any] = List(), context: EZStorageContext = null): Resp[Boolean]

/**
  * 启用记录计数
  *
  * @param condition  条件，SQL (相当于Where中的条件)或Json
  * @param parameters 参数 ，Mongo不需要
  * @param context    上下文
  * @return 条数
  */
def countEnabled(condition: String, parameters: List[Any] = List(), context: EZStorageContext = null): Resp[Long]

/**
  * 启用一条记录
  *
  * @param id      主键
  * @param context 上下文
  * @return 启用结果
  */
def enableById(id: Any, context: EZStorageContext = null): Resp[Void]

/**
  * 禁用一条记录
  *
  * @param id      主键
  * @param context 上下文
  * @return 禁用结果
  */
def disableById(id: Any, context: EZStorageContext = null): Resp[Void]</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
以上所有方法都有<code>preX</code>和<code>postX</code>方法对，可以在实现的storage中重写以用于操作前及操作后处理，系统仅对操作前返回<code>Resp.success()</code>的结果做后续操作
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="truemongo-2"><a class="anchor" href="#truemongo-2"></a>Mongo特殊方法</h5>
<div class="listingblock">
<div class="title">继承自MongoBaseStorage[E]的方法</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala"> /**
   * 附加条件查找
   * @param condition 过滤条件
   * @param sort 排序
   * @param limit 获取记录数，默认为0，表示获取所有
   * @param context 上下文
   * @return 查找结果
   */
 def findWithOpt(condition: String = "{}", sort: Map[String, SortEnum], limit: Int = 0, context: EZStorageContext = EZStorageContext()): Resp[List[M]]

 /**
   * 附加条件分页
   * @param condition  过滤条件
   * @param pageNumber 当前页，从1开始
   * @param pageSize   每页条数
   * @param sort 排序
   * @param context 上下文
   * @return 分页结果
   */
 def pageWithOpt(
                  condition: String = "{}", pageNumber: Long = 1, pageSize: Int = 10,
                  sort: Map[String, SortEnum] = Map(), context: EZStorageContext = null): Resp[Page[M]]

 /**
   * 聚合计算
   *
   * 例如：
   * [{ "$$match": {&lt;过滤条件&gt;} },
   *  {
   *    // Group
   *    "$$group": {
   *       "_id": {
   *           "platform":"$$platform",
   *           "component":"$$component",
   *           "module":"$$module",
   *           "stage":"$$stage"
   *       },
   *       "count": { "$$sum": 1 }
   *  }
   * }]
   * @param condition 计算条件
   * @param context 上下文
   * @return 计算结果
   */
 def aggregate(condition: JsonArray, context: EZStorageContext = null): Resp[JsonArray]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--11"><a class="anchor" href="#true--11"></a>6.6.3. 适配器使用</h4>
<div class="paragraph">
<p>当业务模块需要可选择支持Mongo或JDBC时可以用适配器，以减少业务编码</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">// 先定义一个基础持久化类，可继承BaseStorage[E]、StatusStorage[E]或SecureStorage[E]
// 此类不能混入Mongo或JDBC信息
trait EZ_Role_Base extends SecureStorage[EZ_Role] with StatusStorage[EZ_Role] {

  // 这里可以重写前置或后置方法
  override def preSaveOrUpdate(model: EZ_Role, context: EZStorageContext): Resp[EZ_Role] = {
    if (model.flag == null || model.flag.trim.isEmpty) {
      Resp.badRequest("Require【flag】")
    } else {
      if (model.flag.contains(BaseModel.SPLIT)) {
        Resp.badRequest(s"【flag】can't contains ${BaseModel.SPLIT}")
      } else {
        model.code = assembleCode(model.flag, model.organization_code)
        super.preSaveOrUpdate(model, context)
      }
    }
  }

  // 可以添加自定义方法
  def findByOrganizationCode(organizationCode: String): Resp[List[EZ_Role]]

}

// 用Mongo实现自定义方法
object EZ_Role_Mongo extends MongoSecureStorage[EZ_Role] with MongoStatusStorage[EZ_Role] with EZ_Role_Base {
  override def findByOrganizationCode(organizationCode: String): Resp[List[EZ_Role]] = {
    find(s"""{"organization_code":"$organizationCode"}""")
  }
}

// 用JDBC实现自定义方法
object EZ_Role_JDBC extends JDBCSecureStorage[EZ_Role] with JDBCStatusStorage[EZ_Role] with EZ_Role_Base {
  override def findByOrganizationCode(organizationCode: String): Resp[List[EZ_Role]] = {
    find(s"""organization_code = ?""", List(organizationCode))
  }
}

// 添加适配器类，每个Storage都有对应的Adapter
// Adapter[E,T]两个泛型分别代表 实体及对应的基础持久化类
object EZ_Role extends SecureStorageAdapter[EZ_Role, EZ_Role_Base]
  with StatusStorageAdapter[EZ_Role, EZ_Role_Base] with EZ_Role_Base {

  // 重写storageObj属性，根据外部条件选择使用Mongo或JDBC
  override protected val storageObj: EZ_Role_Base =
    if (&lt;外部条件&gt;) EZ_Role_Mongo else EZ_Role_JDBC

  // 重写基础持久化类中对应的自定义方法，应用对应的方法
  override def findByOrganizationCode(organizationCode: String): Resp[List[EZ_Role]] = storageObj.findByOrganizationCode(organizationCode)

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truemongo-api"><a class="anchor" href="#truemongo-api"></a>6.6.4. Mongo低层API使用</h4>
<div class="sect4">
<h5 id="true--12"><a class="anchor" href="#true--12"></a>同步操作</h5>
<div class="listingblock">
<div class="title">MongoProcessor</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">/**
  * 保存
  *
  * @param collection 集合名
  * @param save       保存的Json对象
  * @return 保存结果
  */
def save(collection: String, save: JsonObject): Resp[String]

/**
  * 更新
  *
  * @param collection 集合名
  * @param id         要更新的_id
  * @param update     更新的Json对象
  * @return 更新结果
  */
def update(collection: String, id: String, update: JsonObject): Resp[String]

/**
  * 保存或更新，存在主键做保存，反之更新
  *
  * @param collection   集合名
  * @param saveOrUpdate 保存或更新的Json对象
  * @return 保存或更新结果
  */
def saveOrUpdate(collection: String, saveOrUpdate: JsonObject): Resp[String]

/**
  * 更新
  *
  * @param collection 集合名
  * @param query      更新条件，Json格式
  * @param update     更新的Json对象
  * @return 更新结果
  */
def updateByCond(collection: String, query: JsonObject, update: JsonObject): Resp[Void]

/**
  * 删除
  *
  * @param collection 集合名
  * @param query      删除条件，Json格式
  * @return 删除结果
  */
def deleteByCond(collection: String, query: JsonObject): Resp[Void]

/**
  * 删除
  *
  * @param collection 集合名
  * @param id         删除_id
  * @return 删除结果
  */
def deleteById(collection: String, id: String): Resp[Void]

/**
  * 计数
  *
  * @param collection 集合名
  * @param query      计数条件，Json格式
  * @return 计数结果
  */
def count(collection: String, query: JsonObject): Resp[Long]

/**
  * 获取一条记录
  *
  * @param collection  集合名
  * @param id          记录_id
  * @param resultClass 记录类型
  * @tparam E 记录类型
  * @return 获取到的记录
  */
def getById[E](collection: String, id: String, resultClass: Class[E]): Resp[E]

/**
  * 获取一条记录
  *
  * @param collection  集合名
  * @param query       获取条件，Json格式
  * @param resultClass 记录类型
  * @tparam E 记录类型
  * @return 获取到的记录
  */
def getByCond[E](collection: String, query: JsonObject, resultClass: Class[E]): Resp[E]

/**
  * 查找
  *
  * @param collection  集合名
  * @param query       查找条件，Json格式
  * @param sort        排序方式
  * @param limit       获取条数
  * @param resultClass 记录类型
  * @tparam E 记录类型
  * @return 获取到的记录
  */
def find[E](collection: String, query: JsonObject, sort: JsonObject, limit: Int, resultClass: Class[E]): Resp[List[E]]

/**
  * 分页
  *
  * @param collection  集合名
  * @param query       分页条件，Json格式
  * @param pageNumber  当前页，从1开始
  * @param pageSize    每页条数
  * @param sort        排序方式
  * @param resultClass 记录类型
  * @tparam E 记录类型
  * @return 获取到的记录
  */
def page[E](collection: String, query: JsonObject, pageNumber: Long, pageSize: Int, sort: JsonObject, resultClass: Class[E]): Resp[Page[E]]

/**
  * 判断是否存在
  *
  * @param collection 集合名
  * @param query      是否存在条件，Json格式
  * @return 是否存在
  */
def exist(collection: String, query: JsonObject): Resp[Boolean]

/**
  * 聚合操作
  *
  * @param collection 集合名
  * @param query      聚合条件，Json格式
  * @return 操作结果
  */
def aggregate(collection: String, query: JsonArray): Resp[JsonArray]</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="true--13"><a class="anchor" href="#true--13"></a>异步操作</h5>
<div class="listingblock">
<div class="title">MongoProcessor.Async</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">/**
  * 保存
  *
  * @param collection 集合名
  * @param save       保存的Json对象
  * @return 保存结果
  */
def save(collection: String, save: JsonObject): Future[Resp[String]]

/**
  * 更新
  *
  * @param collection 集合名
  * @param id         要更新的_id
  * @param update     更新的Json对象
  * @return 更新结果
  */
def update(collection: String, id: String, update: JsonObject): Future[Resp[String]]

/**
  * 保存或更新，存在主键做保存，反之更新
  *
  * @param collection   集合名
  * @param saveOrUpdate 保存或更新的Json对象
  * @return 保存或更新结果
  */
def saveOrUpdate(collection: String, saveOrUpdate: JsonObject): Future[Resp[String]]

/**
  * 更新
  *
  * @param collection 集合名
  * @param query      更新条件，Json格式
  * @param update     更新的Json对象
  * @return 更新结果
  */
def updateByCond(collection: String, query: JsonObject, update: JsonObject): Future[Resp[Void]]

/**
  * 删除
  *
  * @param collection 集合名
  * @param query      删除条件，Json格式
  * @return 删除结果
  */
def deleteByCond(collection: String, query: JsonObject): Future[Resp[Void]]

/**
  * 删除
  *
  * @param collection 集合名
  * @param id         删除_id
  * @return 删除结果
  */
def deleteById(collection: String, id: String): Future[Resp[Void]]

/**
  * 计数
  *
  * @param collection 集合名
  * @param query      计数条件，Json格式
  * @return 计数结果
  */
def count(collection: String, query: JsonObject): Future[Resp[Long]]

/**
  * 获取一条记录
  *
  * @param collection  集合名
  * @param id          记录_id
  * @param resultClass 记录类型
  * @tparam E 记录类型
  * @return 获取到的记录
  */
def getById[E](collection: String, id: String, resultClass: Class[E]): Future[Resp[E]]

/**
  * 获取一条记录
  *
  * @param collection  集合名
  * @param query       获取条件，Json格式
  * @param resultClass 记录类型
  * @tparam E 记录类型
  * @return 获取到的记录
  */
def getByCond[E](collection: String, query: JsonObject, resultClass: Class[E]): Future[Resp[E]]

/**
  * 查找
  *
  * @param collection  集合名
  * @param query       查找条件，Json格式
  * @param sort        排序方式
  * @param limit       获取条数
  * @param resultClass 记录类型
  * @tparam E 记录类型
  * @return 获取到的记录
  */
def find[E](collection: String, query: JsonObject, sort: JsonObject, limit: Int, resultClass: Class[E]): Future[Resp[List[E]]]

/**
  * 分页
  *
  * @param collection  集合名
  * @param query       分页条件，Json格式
  * @param pageNumber  当前页，从1开始
  * @param pageSize    每页条数
  * @param sort        排序方式
  * @param resultClass 记录类型
  * @tparam E 记录类型
  * @return 获取到的记录
  */
def page[E](collection: String, query: JsonObject, pageNumber: Long, pageSize: Int, sort: JsonObject, resultClass: Class[E]): Future[Resp[Page[E]]]

/**
  * 判断是否存在
  *
  * @param collection 集合名
  * @param query      是否存在条件，Json格式
  * @return 是否存在
  */
def exist(collection: String, query: JsonObject): Future[Resp[Boolean]]

/**
  * 聚合操作
  *
  * @param collection 集合名
  * @param query      聚合条件，Json格式
  * @return 操作结果
  */
def aggregate(collection: String, query: JsonArray): Future[Resp[JsonArray]]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truemongo-api-2"><a class="anchor" href="#truemongo-api-2"></a>6.6.5. Mongo低层API使用</h4>
<div class="sect4">
<h5 id="true--14"><a class="anchor" href="#true--14"></a>同步操作</h5>
<div class="listingblock">
<div class="title">JDBCProcessor</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">  /**
    * update
    *
    * @param sql        sql
    * @param parameters 参数
    * @param conn       已存在的connection，为空时会新建
    * @return update结果
    */
  def update(sql: String, parameters: List[Any] = null, conn: SQLConnection = null): Resp[Void]

  /**
    * 批处理
    *
    * @param sql           sql
    * @param parameterList 参数列表
    * @param conn          已存在的connection，为空时会新建
    * @return 处理结果
    */
  def batch(sql: String, parameterList: List[List[Any]] = null, conn: SQLConnection = null): Resp[Void]

  /**
    * 获取一条记录
    *
    * @param sql         sql
    * @param parameters  参数
    * @param resultClass 记录类型
    * @param conn        已存在的connection，为空时会新建
    * @tparam E 记录类型
    * @return 获取到的记录
    */
  def get[E](sql: String, parameters: List[Any], resultClass: Class[E], conn: SQLConnection = null): Resp[E]

  /**
    * 查找
    *
    * @param sql         sql
    * @param parameters  参数
    * @param resultClass 记录类型
    * @param conn        已存在的connection，为空时会新建
    * @tparam E 记录类型
    * @return 获取到的记录
    */
  def find[E](sql: String, parameters: List[Any], resultClass: Class[E], conn: SQLConnection = null): Resp[List[E]]

  /**
    * 分页
    *
    * @param sql         sql
    * @param parameters  参数
    * @param pageNumber  当前页，从1开始
    * @param pageSize    每页条数
    * @param resultClass 记录类型
    * @param conn        已存在的connection，为空时会新建
    * @tparam E 记录类型
    * @return 获取到的记录
    */
  def page[E](sql: String, parameters: List[Any], pageNumber: Long, pageSize: Int, resultClass: Class[E], conn: SQLConnection = null): Resp[Page[E]]

  /**
    * 计数
    *
    * @param sql        sql
    * @param parameters 参数
    * @param conn       已存在的connection，为空时会新建
    * @return 计数结果
    */
  def count(sql: String, parameters: List[Any], conn: SQLConnection = null): Resp[Long]

  /**
    * 判断是否存在
    *
    * @param sql        sql
    * @param parameters 参数
    * @param conn       已存在的connection，为空时会新建
    * @return 是否存在
    */
  def exist(sql: String, parameters: List[Any], conn: SQLConnection = null): Resp[Boolean]

  /**
    * 开始事务
    *
    * @return 当前事务的连接信息
    */
  def openTx(): SQLConnection

  /**
    * 回滚事务
    *
    * @param conn 当前事务的连接信息
    */
  def rollback(conn: SQLConnection): Unit

  /**
    * 提交事务
    *
    * @param conn 当前事务的连接信息
    */
  def commit(conn: SQLConnection): Unit</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="true--15"><a class="anchor" href="#true--15"></a>异步操作</h5>
<div class="listingblock">
<div class="title">JDBCProcessor.Async</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">/**
      * update
      *
      * @param sql        sql
      * @param parameters 参数
      * @param conn       已存在的connection，为空时会新建
      * @return update结果
      */
    def update(sql: String, parameters: List[Any] = null, conn: SQLConnection = null): Future[Resp[Void]]

    /**
      * 批处理
      *
      * @param sql           sql
      * @param parameterList 参数列表
      * @param conn          已存在的connection，为空时会新建
      * @return 处理结果
      */
    def batch(sql: String, parameterList: List[List[Any]], conn: SQLConnection = null): Future[Resp[Void]]

    /**
      * 获取一条记录
      *
      * @param sql         sql
      * @param parameters  参数
      * @param resultClass 记录类型
      * @param conn        已存在的connection，为空时会新建
      * @tparam E 记录类型
      * @return 获取到的记录
      */
    def get[E](sql: String, parameters: List[Any], resultClass: Class[E], conn: SQLConnection = null): Future[Resp[E]]

    /**
      * 查找
      *
      * @param sql         sql
      * @param parameters  参数
      * @param resultClass 记录类型
      * @param conn        已存在的connection，为空时会新建
      * @tparam E 记录类型
      * @return 获取到的记录
      */
    def find[E](sql: String, parameters: List[Any], resultClass: Class[E], conn: SQLConnection = null): Future[Resp[List[E]]]

    /**
      * 分页
      *
      * @param sql         sql
      * @param parameters  参数
      * @param pageNumber  当前页，从1开始
      * @param pageSize    每页条数
      * @param resultClass 记录类型
      * @param conn        已存在的connection，为空时会新建
      * @tparam E 记录类型
      * @return 获取到的记录
      */
    def page[E](sql: String, parameters: List[Any], pageNumber: Long, pageSize: Int,
                resultClass: Class[E], conn: SQLConnection = null): Future[Resp[Page[E]]]

    /**
      * 计数
      *
      * @param sql        sql
      * @param parameters 参数
      * @param conn       已存在的connection，为空时会新建
      * @return 计数结果
      */
    def count(sql: String, parameters: List[Any], conn: SQLConnection = null): Future[Resp[Long]]

    /**
      * 判断是否存在
      *
      * @param sql        sql
      * @param parameters 参数
      * @param conn       已存在的connection，为空时会新建
      * @return 是否存在
      */
    def exist(sql: String, parameters: List[Any], conn: SQLConnection = null): Future[Resp[Boolean]]

    /**
      * 开始事务
      *
      * @return 当前事务的连接信息
      */
    def openTx(): Future[SQLConnection]

    /**
      * 回滚事务
      *
      * @param conn 当前事务的连接信息
      * @return 是否成功
      */
    def rollback(conn: SQLConnection): Future[Void]

    /**
      * 提交事务
      *
      * @param conn 当前事务的连接信息
      * @return 是否成功
      */
    def commit(conn: SQLConnection): Future[Void]</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truerpc"><a class="anchor" href="#truerpc"></a>7. RPC服务</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="true--16"><a class="anchor" href="#true--16"></a>7.1. 功能</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>支持HTTP和WebSocket服务</p>
</li>
<li>
<p>基于注解服务发现</p>
</li>
<li>
<p>Restful风格，支持GET POST PUT DELETE等常用方法</p>
</li>
<li>
<p>支持HTTPS</p>
</li>
<li>
<p>支持Json跨域请求</p>
</li>
<li>
<p>支持拦截器栈，可适配权限认证等服务</p>
</li>
<li>
<p>提供同步及异步HTTP客户端</p>
</li>
<li>
<p>提供CRUD脚手架服务</p>
</li>
<li>
<p>支持HTML与XML处理</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true5-2"><a class="anchor" href="#true5-2"></a>7.2. 5分钟上手</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>添加依赖</p>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
  &lt;groupId&gt;com.ecfront&lt;/groupId&gt;
  &lt;artifactId&gt;ezf-rpc-&lt;http或websocket&gt;&lt;/artifactId&gt;
  &lt;version&gt;3.0.0-SNAPSHOT&lt;/version&gt;
&lt;dependency&gt;</pre>
</div>
</div>
</li>
<li>
<p>添加配置</p>
<div class="literalblock">
<div class="content">
<pre>// HTTP
"rpc.http": {
  "servicePath": "com.foo.api"
}</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>// 或 WebSocket
"rpc.websocket": {
  "servicePath": "com.foo.api"
}</pre>
</div>
</div>
</li>
<li>
<p>在<code>com.foo.api</code>包下添加scala类</p>
<div class="literalblock">
<div class="content">
<pre>@RPC("/test/")
@HTTP 或 @WebSocket
object TestService {
   @POST("") 或 @REQUEST("")
   def getTest(parameter: Map[String, String],body:String, context: EZRPCContext): Resp[String] = {
     Resp.success(String)
   }
}</pre>
</div>
</div>
</li>
<li>
<p>启动服务</p>
<div class="literalblock">
<div class="content">
<pre>EZManager.start()</pre>
</div>
</div>
</li>
<li>
<p>访问</p>
<div class="literalblock">
<div class="content">
<pre>// HTTP
POST http://127.0.0.1/test/" body: "Hello World"
返回 "Hello World"</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>// 或 WebSocket
写个HTML页面
&lt;html&gt;
&lt;head&gt;&lt;/head&gt;
&lt;script&gt;
    var socket_resource;
    if (window.WebSocket) {
        socket= new WebSocket("ws://localhost/test/");
        socket.onmessage = function (event) {
            console.log("received : " + JSON.parse(event.data));
        };
        socket.onopen = function (event) {
            console.log("opened!");
        };
        socket.onclose = function (event) {
            console.log("closed.");
        };
    } else {
        alert("Your browser does not support Websockets. (Use Chrome)");
    }
    function send() {
        socket.send(JSON.stringify({
            f1: "1111"
        }));
    }
&lt;/script&gt;
&lt;body&gt;
&lt;input id="btnSend" type="button" value="POST" onclick="send()"/&gt;
&lt;/body&gt;
&lt;/html&gt;
打开测试，OK</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true--17"><a class="anchor" href="#true--17"></a>7.3. 依赖</h3>
<div class="paragraph">
<p>服务依赖：storage.mongo或storage.jdbc（可选，使用CRUD脚手架服务时必选）</p>
</div>
</div>
<div class="sect2">
<h3 id="truehttp"><a class="anchor" href="#truehttp"></a>7.4. HTTP配置</h3>
<div class="listingblock">
<div class="content">
<pre>"rpc.http": {
  "servicePath": "", <i class="conum" data-value="1"></i><b>(1)</b>
  "host": "127.0.0.1", <i class="conum" data-value="2"></i><b>(2)</b>
  "port": 80/443, <i class="conum" data-value="3"></i><b>(3)</b>
  "publicUrl": "", <i class="conum" data-value="4"></i><b>(4)</b>
  "webUrl": "", <i class="conum" data-value="5"></i><b>(5)</b>
  "resourcePath": "/tmp/", <i class="conum" data-value="6"></i><b>(6)</b>
  "accessControlAllowOrigin": "*", <i class="conum" data-value="7"></i><b>(7)</b>
  "ssl": { <i class="conum" data-value="8"></i><b>(8)</b>
    "keyPath": "", <i class="conum" data-value="9"></i><b>(9)</b>
    "keyPassword": "" <i class="conum" data-value="10"></i><b>(10)</b>
  },
  monitor": { <i class="conum" data-value="11"></i><b>(11)</b>
    "slow": {<i class="conum" data-value="12"></i><b>(12)</b>
      "time": 10000, <i class="conum" data-value="13"></i><b>(13)</b>
      "includes": [], <i class="conum" data-value="14"></i><b>(14)</b>
      "excludes": [] <i class="conum" data-value="15"></i><b>(15)</b>
    }
  }
}</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>HTTP服务发现的根包，系统会以此包为基础，扫描子孙路径下所有带@RPC及@HTTP的类，并将其类中带@GET @POST @PUT @DELETE注解的方法加入到路由表中</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>IP或主机名</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>端口号，HTTP默认80，HTTPS默认443</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>对外开放的URL，默认是 <code>http(s)://host:port/</code>，服务需要对外发布、代理转发等场景下可以配置此项向外暴露服务，在用户注册激活及找回密码等功能时会发送以此URL开头的链接</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Web页面的URL，默认同<code>publicUrl</code>，此配置用于用户注册激活及找回密码等功能时跳转到登录页面时做为登录登录URL的前缀路径</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>资源目录，上传文件的基础目录</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>跨域请求允许的来源域，*表示允许所有域</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>SSL配置</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>SSL证书路径，可以是绝对路径，也可以是相对路径</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>SSL证书密码</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>是否使用请求监控</td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>是否使用慢请求监控</td>
</tr>
<tr>
<td><i class="conum" data-value="13"></i><b>13</b></td>
<td>慢请求时间定义，请求大于此时间会记录到日志，单位毫秒</td>
</tr>
<tr>
<td><i class="conum" data-value="14"></i><b>14</b></td>
<td>包含的请求URI，如果此字段存在，那么只会记录此URI中的请求，格式：method:uri</td>
</tr>
<tr>
<td><i class="conum" data-value="15"></i><b>15</b></td>
<td>排除的请求URI，如果此字段存在，那么在此URI中的请求都不会记录，格式：method:uri</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
资源目录(resourcePath），需要禁用此目录及子孙目录的执行权限
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
SSL证书路径为相对路径时，它的根路径查找顺序为 1）启动参数中conf指定的路径，2）当前的classPath，3）./config/
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>includes</code>和<code>excludes</code>是排他的，当<code>includes</code>不为空时<code>excludes</code>将失效
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="truewebsocket"><a class="anchor" href="#truewebsocket"></a>7.5. WebSocket配置</h3>
<div class="listingblock">
<div class="content">
<pre>"rpc.websocket": {
  "servicePath": "", <i class="conum" data-value="1"></i><b>(1)</b>
  "host": "127.0.0.1", <i class="conum" data-value="2"></i><b>(2)</b>
  "port": 80 <i class="conum" data-value="3"></i><b>(3)</b>
}</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>WebSocket服务发现的根包，系统会以此包为基础，扫描子孙路径下所有带@RPC及@WebSocket的类，并将其类中带@REQUEST注解的方法加入到路由表中</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>IP或主机名</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>端口号</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="true--18"><a class="anchor" href="#true--18"></a>7.6. 使用</h3>
<div class="sect3">
<h4 id="truehttp-2"><a class="anchor" href="#truehttp-2"></a>7.6.1. HTTP服务注解及方法定义</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala"> @RPC("/test/") // 指定RPC注解，参数`/test/`表示uri的根路径
 @HTTP // 指定HTTP注解，表示此类可提供HTTP服务
 object DemoService { // 服务可以是object或class

     // 此注解表示此方法对应于HTTP的GET请求
     // 参数为空表示请求的路径是就是根据路径，可接收的请求为 GET /test/
     // 如果参数是 @GET("a/b/c/") 则可接收的请求为 GET /test/a/b/c/
     // 如果要重写根据路径参数以'/'开始即可，如 @GET("/a/b/c/") 则可接收的请求为 GET /a/b/c/
     // 如果参数中带有变量使用':'指定，如 @GET("a/:b/:c/") 则可接收的请求为 GET /test/a/111/222/，方法参数parameter会映射b与c的值
     @GET("")
     // 对于 @GET 和 @DELETE 请求而言，方法的行参有两个
     //    第一个类型是Map[String,String]，用于保存URL中的变量及search值，如 @GET(":id/")，请求为 GET /test/111/?token=sss，则此参数的值为 Map("id" -&gt; "111","token" -&gt; "sss")
     //    第二个类型是EZRPCContext及其子类，保存了请求上下文
     //       请求上下文的参数有：
     //           请求方法 method
     //           请求对应的模块URI（可能带通配符） templateUri
     //           请求的真实URI  realUri
     //           请求URL中的参数  parameters
     //           远程IP remoteIP
     //           请求的Accept accept
     //           请求的ContentType  contentType
     // 返回值必须为Resp封装的类型
     //    Resp中有code，message及body三个属性：
     //      code是返回的业务状态码，与HTTP类似，200表示成功
     //      message是错误的消息描述
     //      body是成功返回的真实对象，在context-Type 是 `*/json`时会将对象转成Json字符串格式返回
     // 几个特殊返回类型：
     //    Resp[File] 返回下载文件流
     //    Resp[RespRedirect] 页面重定向
     //    Resp[Raw] 返回未封装的原始对象
     //    Resp[Document] 当context-Type 是 `text/xml` 时用于返回xml信息（去除Resp封装），xml可由Jsoup处理
     def getTest(parameter: Map[String, String],context: EZRPCContext): Resp[String] = {
       //Resp有多个方法，success表示成功，还有诸如notFound、badRequest、unAuthorized等预定义的错误
       Resp.success("Hello World")
     }

     // 此注解表示此方法对应于HTTP的POST请求
    @POST("")
    // 对于 @POST 和 @PUT 请求而言，方法的行参有三个
    //    第一个和第三个同 @GET 或 @DELETE 请求
    //    第二是任意类型*，系统会将请求body解析成对应的对象
    def getTest(parameter: Map[String, String],body:String, context: EZRPCContext): Resp[String] = {
      Resp.success(String)
    }

 }</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
目前POST及PUT请求体不支持直接解析自定义泛型对象，内置类型泛型如Map[String,String]没有问题，但如List[EZ_Resource]这些自定义类型做为泛型时请先使用string（body:String）接收，然后使用JsonHelper.toObject[List[EZ_Resource]](body)转换
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
URI必须严格对应，如 <code>/test</code> 与 <code>/test/</code> 不是同一个路径
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
URI变量以 <code>:</code> 开头，变量名只能是字母或数字
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="truewebsocket-2"><a class="anchor" href="#truewebsocket-2"></a>7.6.2. WebSocket服务注解及方法定义</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala"> @RPC("/test/") // 指定RPC注解，参数`/test/`表示uri的根路径
 @WebSocket // 指定WebSocket注解，表示此类可提供WebSocket服务
 object DemoService {

     // 此注解表示此方法支持WebSocket请求，方法形参与HTTP的@POST类似
     @REQUEST("")
     def getTest(parameter: Map[String, String],body:String,context: EZRPCContext): Resp[String] = {
       Resp.success("Hello World")
     }

 }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truesimplehttpservice"><a class="anchor" href="#truesimplehttpservice"></a>7.6.3. SimpleHttpService脚手架</h4>
<div class="paragraph">
<p>为简化常规的CRUD应用，可继承SimpleHttpService，此类中已定义了基本的CRUD、上传、下载、导出等操作</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">@RPC("/resource/")
@HTTP
// 继承SimpleHttpService以实现基础服务
// SimpleHttpService第一个泛型指定操作的实体类型，第二个泛型指定上下文类型
object ResourceService extends SimpleHttpService[EZ_Resource, EZRPCContext] {
  // 此属性指定持久化的实现，这里使用EZ_Resource的伴生类
  override protected val storageObj: BaseStorage[EZ_Resource] = EZ_Resource
}

// 这里一个实体，带有两个属性，使用详见`storage`服务
@Entity("Resource")
case class EZ_Resource() extends BaseModel with StatusModel{
  @BeanProperty var method: String = _
  @BeanProperty var uri: String = _
}
// 此伴生类表明此实体可以持久化到Mongo，使用详见`storage`服务
object EZ_Resource extends MongoBaseStorage[EZ_Resource] with MongoStatusStorage[EZ_Resource]</code></pre>
</div>
</div>
<div class="paragraph">
<p>上述操作后实现的HTTP服务有：</p>
</div>
<div class="paragraph">
<p><strong>添加新资源</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>POST /resource/ body {"method":"","uri":""}</pre>
</div>
</div>
<div class="paragraph">
<p><strong>更新已有资源</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>PUT /resource/&lt;资源id&gt;/ body {"id":"","method":"","uri":""}</pre>
</div>
</div>
<div class="paragraph">
<p><strong>获取一个资源</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /resource/&lt;资源id&gt;/</pre>
</div>
</div>
<div class="paragraph">
<p><strong>删除一个资源</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>DELETE /resource/&lt;资源id&gt;/</pre>
</div>
</div>
<div class="paragraph">
<p><strong>查找资源列表</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /resource/?condition=&lt;查找条件，sql或mongo json&gt;  condition可选</pre>
</div>
</div>
<div class="paragraph">
<p><strong>查找启用资源列表</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /resource/enable/?condition=&lt;查找条件，sql或mongo json&gt;  condition可选</pre>
</div>
</div>
<div class="paragraph">
<p><strong>分页查找资源列表</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /resource/page/&lt;当前页，从1开始&gt;/&lt;每页显示条数&gt;/?condition=&lt;查找条件，sql或mongo json&gt;  condition可选</pre>
</div>
</div>
<div class="paragraph">
<p><strong>启用一个资源</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /resource/&lt;资源id&gt;/enable/</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
仅在实体继承StatusModel时有效
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>禁用一个资源</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /resource/&lt;资源id&gt;/disable/</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
仅在实体继承StatusModel时有效
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>导出资源列表</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /resource/export/</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
默认会导出所有字段，可能会引发数据安全问题，重写 override protected def allowExportFields = List(&lt;可以导出的字段&gt;) 可以选择导出字段
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
重写 override protected def allowExport = false 可以禁用导出功能
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>上传文件</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>POST /resource/res/</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
重写 override protected def allowUpload = false 可以禁用上传功能
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
重写 override protected def allowUploadTypes 可以选择允许上传的类型，如 allowUploadTypes=List(FileType.TYPE_COMPRESS, FileType.TYPE_IMAGE, FileType.TYPE_OFFICE)表示可以上传压缩、图片、Office文档类型
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
上传文件到：配置文件中的resourcePath + 当前实体的名称 + File.separator + 当前日期(yyyyMMdd) + File.separator
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>下载文件</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET &lt;`上传文件`中返回的uri&gt;</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truehttp-3"><a class="anchor" href="#truehttp-3"></a>7.6.4. HTTP客户端</h4>
<div class="sect4">
<h5 id="true--19"><a class="anchor" href="#true--19"></a>同步操作</h5>
<div class="listingblock">
<div class="title">HttpClientProcessor</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">/**
  * GET 请求
  *
  * @param url         请求URL
  * @param contentType 请求类型，默认为 application/json; charset=utf-8
  * @return 请求结果，string类型
  */
def get(url: String, contentType: String = "application/json; charset=utf-8"): String

/**
  * POST 请求
  *
  * @param url         请求URL
  * @param body        请求体
  * @param contentType 请求类型，默认为 application/json; charset=utf-8
  * @return 请求结果，string类型
  */
def post(url: String, body: Any, contentType: String = "application/json; charset=utf-8"): String

/**
  * PUT 请求
  *
  * @param url         请求URL
  * @param body        请求体
  * @param contentType 请求类型，默认为 application/json; charset=utf-8
  * @return 请求结果，string类型
  */
def put(url: String, body: Any, contentType: String = "application/json; charset=utf-8"): String

/**
  * DELETE 请求
  *
  * @param url         请求URL
  * @param contentType 请求类型，默认为 application/json; charset=utf-8
  * @return 请求结果，string类型
  */
def delete(url: String, contentType: String = "application/json; charset=utf-8"): String</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="true--20"><a class="anchor" href="#true--20"></a>异步操作</h5>
<div class="listingblock">
<div class="title">HttpClientProcessor.Async</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">/**
  * GET 请求
  *
  * @param url         请求URL
  * @param contentType 请求类型，默认为 application/json; charset=utf-8
  * @return 请求结果，string类型
  */
def get(url: String, contentType: String = "application/json; charset=utf-8"): Future[String]

/**
  * POST 请求
  *
  * @param url         请求URL
  * @param body        请求体
  * @param contentType 请求类型，默认为 application/json; charset=utf-8
  * @return 请求结果，string类型
  */
def post(url: String, body: Any, contentType: String = "application/json; charset=utf-8"): Future[String]

/**
  * PUT 请求
  *
  * @param url         请求URL
  * @param body        请求体
  * @param contentType 请求类型，默认为 application/json; charset=utf-8
  * @return 请求结果，string类型
  */
def put(url: String, body: Any, contentType: String = "application/json; charset=utf-8"): Future[String]

/**
  * DELETE 请求
  *
  * @param url         请求URL
  * @param contentType 请求类型，默认为 application/json; charset=utf-8
  * @return 请求结果，string类型
  */
def delete(url: String, contentType: String = "application/json; charset=utf-8"): Future[String]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truewebsocket-3"><a class="anchor" href="#truewebsocket-3"></a>7.6.5. WebSocket消息推送管理</h4>
<div class="listingblock">
<div class="title">WebSocketMessagePushManager</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">/**
  * 向所有客户端推送消息
  *
  * @param method 连接方法，目前只限于 `REQUEST` 方法
  * @param path   连接路径
  * @param data   消息
  */
def ws(method: String, path: String, data: Any): Unit</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--21"><a class="anchor" href="#true--21"></a>8. 认证服务</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="true--22"><a class="anchor" href="#true--22"></a>8.1. 功能</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>支持RBAC的认证服务</p>
</li>
<li>
<p>支持菜单级和资源级（action）的授权</p>
</li>
<li>
<p>支持JDBC或Mongo的持久化</p>
</li>
<li>
<p>支持自助注册及密码找回</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true5-3"><a class="anchor" href="#true5-3"></a>8.2. 5分钟上手</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>添加依赖</p>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
  &lt;groupId&gt;com.ecfront&lt;/groupId&gt;
  &lt;artifactId&gt;ezf-auth&lt;/artifactId&gt;
  &lt;version&gt;3.0.0-SNAPSHOT&lt;/version&gt;
&lt;dependency&gt;</pre>
</div>
</div>
</li>
<li>
<p>添加配置</p>
<div class="literalblock">
<div class="content">
<pre>"auth": {},
"storage.mongo": {
  "host": "&lt;服务IP&gt;",
  "port": 27017,
  "db_name": "test"
},
"rpc.http": {
  "host": "0.0.0.0",
  "port": 8080
},
"redis": {
  "host": "&lt;服务IP&gt;",
  "port": 6379
}</pre>
</div>
</div>
</li>
<li>
<p>启动服务</p>
<div class="literalblock">
<div class="content">
<pre>EZManager.start()</pre>
</div>
</div>
</li>
<li>
<p>登录</p>
<div class="literalblock">
<div class="content">
<pre>POST http://127.0.0.1:8080/public/auth/login/" body: {"id":"admin","password":"admin"}
返回登录信息</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true--23"><a class="anchor" href="#true--23"></a>8.3. 依赖</h3>
<div class="paragraph">
<p>服务依赖：rpc.http、redis、storage.mongo或storage.jdbc、mail（可选，允许注册或开放找回密码功能时必选）</p>
</div>
<div class="paragraph">
<p>环境依赖：redis、mongo或mysql</p>
</div>
</div>
<div class="sect2">
<h3 id="true--24"><a class="anchor" href="#true--24"></a>8.4. 配置</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">"auth": {
  "allowRegister": false, <i class="conum" data-value="1"></i><b>(1)</b>
  "customLogin": false,  <i class="conum" data-value="2"></i><b>(2)</b>
  "selfActive": true, <i class="conum" data-value="3"></i><b>(3)</b>
  "defaultRoleFlag": "user", <i class="conum" data-value="4"></i><b>(4)</b>
  "defaultOrganizationCode": "", <i class="conum" data-value="5"></i><b>(5)</b>
  "publicUriPrefix": "/public/", <i class="conum" data-value="6"></i><b>(6)</b>
  "loginUrl": "#/auth/login", <i class="conum" data-value="7"></i><b>(7)</b>
  "loginKeepSeconds": 0, <i class="conum" data-value="8"></i><b>(8)</b>
  "activeKeepSeconds": 86400, <i class="conum" data-value="9"></i><b>(9)</b>
  "extAccountStorage": "", <i class="conum" data-value="10"></i><b>(10)</b>
  "useRelTable": false, <i class="conum" data-value="11"></i><b>(11)</b>
  "customTables": {  <i class="conum" data-value="12"></i><b>(12)</b>
    "organization": "",  <i class="conum" data-value="13"></i><b>(13)</b>
    "account": "",  <i class="conum" data-value="14"></i><b>(14)</b>
    "resource": "",  <i class="conum" data-value="15"></i><b>(15)</b>
    "role": "",  <i class="conum" data-value="16"></i><b>(16)</b>
    "menu": "",  <i class="conum" data-value="17"></i><b>(17)</b>
    "rel_account_role": "",  <i class="conum" data-value="18"></i><b>(18)</b>
    "rel_role_resource": "",  <i class="conum" data-value="19"></i><b>(19)</b>
    "rel_menu_role": ""  <i class="conum" data-value="20"></i><b>(20)</b>
  },
  "storage":"mongo" <i class="conum" data-value="21"></i><b>(21)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>是否允许注册，注册后账户处于禁用状态，需要激活</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>是否启用自定义登录，如果为true的话默认登录URL会被禁用</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>是否允许自助激活，true：会发送激活邮件自助激活，false：需要管理员手工激活</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>默认角色标识，注册时账户默认的角色</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>默认组织编码，注册时账户默认的组织</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>公开URI的前缀，以此前缀开头的URI不需要认证</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>登录URL，注册或找回密码激活成功后会跳转到登录URL，如果此配置值不带http前缀则使用<code>rpc-http</code>中<code>webUrl</code>做为基础路径</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>登录保持时间，单位秒，指定登录会话多少秒后过期，0表示不过期</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>注册或找回密码激活有效期，单位秒</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>扩展账号持久化类路径，可选，默认对于扩展的账号信息存储在<code>ez_account</code>表中的<code>ext_info</code>字段中，如果需要将扩展信息存储在独立表中时可以定义一个继承自<code>BaseModel</code>的实体及对应的持久化实现，然后指定其类路径</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>是否使用关联表（多对多关联中间表），多用于JDBC持久化，建议在原生不支持json的关系型数据启用此项</td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>是否使用自定义表名</td>
</tr>
<tr>
<td><i class="conum" data-value="13"></i><b>13</b></td>
<td>自定义组织表名</td>
</tr>
<tr>
<td><i class="conum" data-value="14"></i><b>14</b></td>
<td>自定义账户表名</td>
</tr>
<tr>
<td><i class="conum" data-value="15"></i><b>15</b></td>
<td>自定义资源表名</td>
</tr>
<tr>
<td><i class="conum" data-value="16"></i><b>16</b></td>
<td>自定义角色表名</td>
</tr>
<tr>
<td><i class="conum" data-value="17"></i><b>17</b></td>
<td>自定义菜单表名</td>
</tr>
<tr>
<td><i class="conum" data-value="18"></i><b>18</b></td>
<td>自定义账户角色关联表名</td>
</tr>
<tr>
<td><i class="conum" data-value="19"></i><b>19</b></td>
<td>自定义角色资源关联表名</td>
</tr>
<tr>
<td><i class="conum" data-value="20"></i><b>20</b></td>
<td>自定义菜单角色关联表名</td>
</tr>
<tr>
<td><i class="conum" data-value="21"></i><b>21</b></td>
<td>持久化实现，支持<code>mongo</code>或<code>jdbc</code></td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>storage:jdbc &amp; useRelTable不存在或等于false</code>时请执行<code>ez_ddl.sql</code>以创建基础表，<code>storage:jdbc &amp; useRelTable=true</code>时请执行<code>ez_ddl_with_rel.sql</code>以创建带关联表的基础表
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="true--25"><a class="anchor" href="#true--25"></a>8.5. 认证服务接入</h3>
<div class="paragraph">
<p>在原有HTTP服务方法中修改 <code>EZRPCContext</code> 为 <code>EZAuthContext</code> 即可，如</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">@POST("")
def testAuth(parameter: Map[String, String], body: Account_VO, context: EZAuthContext): Resp[Void]</code></pre>
</div>
</div>
<div class="paragraph">
<p>EZAuthContext在EZRPCContext基础上添加了两个字段：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>token 认证的Token值</p>
</li>
<li>
<p>loginInfo 登录信息</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true--26"><a class="anchor" href="#true--26"></a>8.6. 预定义认证接口调用</h3>
<div class="sect3">
<h4 id="true--27"><a class="anchor" href="#true--27"></a>8.6.1. 说明</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>无特殊说明的情况下所有请求的header Content-Type为application/json</p>
</li>
<li>
<p>无特殊说明的情况下所有返回值均为Json，由以下格式构成：</p>
<div class="literalblock">
<div class="content">
<pre>{
  "code":"&lt;状态码，200表示成功，其它表示失败&gt;",
  "message":"&lt;消息，多在出现失败时显示失败原因&gt;",
  "body":"&lt;返回主体内容，不同接口内容不同&gt;"
}</pre>
</div>
</div>
</li>
<li>
<p>如果是分页查询，则返回格式构成如下：</p>
<div class="literalblock">
<div class="content">
<pre>{
  "code":"&lt;状态码，200表示成功，其它表示失败&gt;",
  "message":"&lt;消息，多在出现失败时显示失败原因&gt;",
  "body": {
      "pageNumber": &lt;当前页，从1开始&gt;,
      "pageSize": &lt;每页条数&gt;,
      "pageTotal": &lt;总页数&gt;,
      "recordTotal": &lt;总记录数&gt;,
      "objects": [ 返回主体内容，不同接口内容不同 ]
  }
}</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="true--28"><a class="anchor" href="#true--28"></a>8.6.2. 登录</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>POST /public/auth/login/</pre>
</div>
</div>
<div class="paragraph">
<p>body:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "id":String, // 登录Id或email
  "password":String // 密码
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "token": String, // token，前端需要保存此值，用于后续获取登录信息
  "login_id": String, // 登录id
  "name": String, // 姓名
  "email": String, // email
  "image": String, // 头像URL
  "organization_code": String, // 组织编码
  "role_codes": List[String], // 角色编码列表
  "ext_id": String, // 扩展Id
  "ext_info": Map[String, Any] // 扩展信息
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>ext_id</code>只在使用<code>extAccountStorage</code>时有意义
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="true--29"><a class="anchor" href="#true--29"></a>8.6.3. 注销</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/logout/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null</p>
</div>
</div>
<div class="sect3">
<h4 id="true--30"><a class="anchor" href="#true--30"></a>8.6.4. 获取登录信息</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/logininfo/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>同<code>登录</code>的响应内容主体</p>
</div>
</div>
<div class="sect3">
<h4 id="true--31"><a class="anchor" href="#true--31"></a>8.6.5. 获取菜单（带权限过滤）</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /public/menu/?__ez_token__=&lt;token&gt;  `__ez_token__`可选，不加时显示公共（不需要认证）的菜单</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">[
  {
    "code": String, // 菜单编码
    "uri": String, // 菜单点击的URI
    "name": String, // 菜单名称
    "icon": String, // 菜单图标名称
    "translate": String, // 菜单翻译（i18n用）
    "role_codes": List[String], // 所属角色编码列表
    "parent_code": String, // 父菜单编码，用于多级菜单
    "sort": Int, // 排序，倒序
    "organization_code": String // 所属组织编码
  },
  ...
]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--32"><a class="anchor" href="#true--32"></a>8.6.6. 注册</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>POST /public/register/</pre>
</div>
</div>
<div class="paragraph">
<p>body</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "login_id": String,  // 登录id
  "name": String, // 姓名
  "image": String, // 头像
  "email": String, // Email
  "new_password": String // 密码
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null，允许自助激活时会发送激活邮件</p>
</div>
</div>
<div class="sect3">
<h4 id="true--33"><a class="anchor" href="#true--33"></a>8.6.7. 激活账号</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /public/active/account/&lt;加密字符串&gt;/ 来自邮件中的链接</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>跳转到登录URL 或 返回错误信息</p>
</div>
</div>
<div class="sect3">
<h4 id="true--34"><a class="anchor" href="#true--34"></a>8.6.8. 找回（重置）密码</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>PUT /public/findpassword/&lt;email&gt;/</pre>
</div>
</div>
<div class="paragraph">
<p>body</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "new_password": String  // 新的密码
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null，发送激活邮件</p>
</div>
</div>
<div class="sect3">
<h4 id="true--35"><a class="anchor" href="#true--35"></a>8.6.9. 激活新密码</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /public/active/password/&lt;加密字符串&gt;/ 来自邮件中的链接</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>跳转到登录URL 或 返回错误信息</p>
</div>
</div>
<div class="sect3">
<h4 id="true--36"><a class="anchor" href="#true--36"></a>8.6.10. 获取登录账号信息</h4>
<div class="ulist">
<ul>
<li>
<p>此操作直接从数据中获取数据，上文<code>获取账号信息</code>从缓存中获取</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/account/bylogin/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "id": String,  // 数据库id
  "login_id": String,  // 登录id
  "name": String, // 姓名
  "image": String, // 头像
  "email": String, // Email
  "ext_id": String, // 扩展id
  "ext_info": Map[String, Any] // 扩展信息
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--37"><a class="anchor" href="#true--37"></a>8.6.11. 更新登录账号信息</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>PUT /auth/manage/account/bylogin/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>body</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "name": String, // 姓名
  "image": String, // 头像
  "email": String, // Email
  "current_password": String, // 当前密码
  "new_password": String // 新密码，如果要修改密码此字段必填
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<code>current_password</code>必须填写正确，否则无法修改
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null</p>
</div>
</div>
<div class="sect3">
<h4 id="true--38"><a class="anchor" href="#true--38"></a>8.6.12. （管理接口）添加资源</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>POST /auth/manage/resource/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>body</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "method": String,  // Http方法，大写
  "uri": String,  // 资源URI
  "name": String // 资源名称
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "id": String,  // 数据库id
  "code": String,  // 资源编码
  "method": String,  // Http方法，大写
  "uri": String,  // 资源uri
  "name": String, // 资源名称
  "enable": Boolean, // 是否启用
  "create_user": String, // 创建用户login_id
  "create_org": String, // 创建组织编码
  "create_time": Long, // 创建时间（yyyyMMddHHmmssSSS）
  "update_user": String, // 更新用户login_id
  "update_org": String, // 更新组织编码
  "update_time": Long // 更新时间（yyyyMMddHHmmssSSS）
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--39"><a class="anchor" href="#true--39"></a>8.6.13. （管理接口）更新资源</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>PUT /auth/manage/resource/&lt;资源id&gt;/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>body</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "name": String // 资源名称
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
只能修改<code>name</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>同<code>（管理接口）添加资源</code>的响应内容主体</p>
</div>
</div>
<div class="sect3">
<h4 id="true--40"><a class="anchor" href="#true--40"></a>8.6.14. （管理接口）查找资源列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/resource/?__ez_token__=&lt;token&gt;&amp;condition=&lt;查找条件，sql或mongo json&gt;  condition可选</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">[
  {
   同`（管理接口）添加资源`的响应内容主体
  },
  ...
]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--41"><a class="anchor" href="#true--41"></a>8.6.15. （管理接口）查找启用资源列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/resource/enable/?__ez_token__=&lt;token&gt;&amp;condition=&lt;查找条件，sql或mongo json&gt;  condition可选</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>同<code>（管理接口）查找启用资源列表</code>的响应内容主体</p>
</div>
</div>
<div class="sect3">
<h4 id="true--42"><a class="anchor" href="#true--42"></a>8.6.16. （管理接口）分页查找资源列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/resource/page/&lt;当前页，从1开始&gt;/&lt;每页显示条数&gt;/?__ez_token__=&lt;token&gt;&amp;condition=&lt;查找条件，sql或mongo json&gt;  condition可选</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "pageNumber":Long, // 当前页，从1开始
  "pageSize":Int, // 每页显示条数
  "pageTotal":Long, // 总共页数
  "recordTotal":Long, // 总共记录数
  // 当前页的实体列表
  "objects":[
    {
     同`（管理接口）添加资源`的响应内容主体
    },
    ...
  ]
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--43"><a class="anchor" href="#true--43"></a>8.6.17. （管理接口）获取一个资源</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/resource/&lt;资源id&gt;/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>同<code>（管理接口）添加资源</code>的响应内容主体</p>
</div>
</div>
<div class="sect3">
<h4 id="true--44"><a class="anchor" href="#true--44"></a>8.6.18. （管理接口）删除一个资源</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>DELETE /auth/manage/resource/&lt;资源id&gt;/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null</p>
</div>
</div>
<div class="sect3">
<h4 id="true--45"><a class="anchor" href="#true--45"></a>8.6.19. （管理接口）启用一个资源</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/resource/&lt;资源id&gt;/enable/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null</p>
</div>
</div>
<div class="sect3">
<h4 id="true--46"><a class="anchor" href="#true--46"></a>8.6.20. （管理接口）禁用一个资源</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/resource/&lt;资源id&gt;/disable/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null</p>
</div>
</div>
<div class="sect3">
<h4 id="true--47"><a class="anchor" href="#true--47"></a>8.6.21. （管理接口）导出资源列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/resource/export/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>资源中可导出字段的列表，格式为逗号分割符</p>
</div>
</div>
<div class="sect3">
<h4 id="true--48"><a class="anchor" href="#true--48"></a>8.6.22. （管理接口）添加组织</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>POST /auth/manage/organization/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>body</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "code": String,  // 编码编码
  "name": String, // 组织名称
  "image": String // 组织图标
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "id": String,  // 数据库id
  "code": String,  // 编码编码
  "name": String, // 组织名称
  "image": String, // 组织图标
  "enable": Boolean, // 是否启用
  "create_user": String, // 创建用户login_id
  "create_org": String, // 创建组织编码
  "create_time": Long, // 创建时间（yyyyMMddHHmmssSSS）
  "update_user": String, // 更新用户login_id
  "update_org": String, // 更新组织编码
  "update_time": Long // 更新时间（yyyyMMddHHmmssSSS）
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--49"><a class="anchor" href="#true--49"></a>8.6.23. （管理接口）更新组织</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>PUT /auth/manage/organization/&lt;组织id&gt;/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>body</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "name": String, // 组织名称
  "image": String // 组织图标
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
只能修改<code>name</code>和<code>image</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>同<code>（管理接口）添加组织</code>的响应内容主体</p>
</div>
</div>
<div class="sect3">
<h4 id="true--50"><a class="anchor" href="#true--50"></a>8.6.24. （管理接口）查找组织列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/organization/?__ez_token__=&lt;token&gt;&amp;condition=&lt;查找条件，sql或mongo json&gt;  condition可选</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">[
  {
   同`（管理接口）添加组织`的响应内容主体
  },
  ...
]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--51"><a class="anchor" href="#true--51"></a>8.6.25. （管理接口）查找启用组织列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/organization/enable/?__ez_token__=&lt;token&gt;&amp;condition=&lt;查找条件，sql或mongo json&gt;  condition可选</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>同<code>（管理接口）查找启用组织列表</code>的响应内容主体</p>
</div>
</div>
<div class="sect3">
<h4 id="true--52"><a class="anchor" href="#true--52"></a>8.6.26. （管理接口）分页查找组织列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/organization/page/&lt;当前页，从1开始&gt;/&lt;每页显示条数&gt;/?__ez_token__=&lt;token&gt;&amp;condition=&lt;查找条件，sql或mongo json&gt;  condition可选</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "pageNumber":Long, // 当前页，从1开始
  "pageSize":Int, // 每页显示条数
  "pageTotal":Long, // 总共页数
  "recordTotal":Long, // 总共记录数
  // 当前页的实体列表
  "objects":[
    {
     同`（管理接口）添加组织`的响应内容主体
    },
    ...
  ]
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--53"><a class="anchor" href="#true--53"></a>8.6.27. （管理接口）获取一个组织</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/organization/&lt;组织id&gt;/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>同<code>（管理接口）添加组织</code>的响应内容主体</p>
</div>
</div>
<div class="sect3">
<h4 id="true--54"><a class="anchor" href="#true--54"></a>8.6.28. （管理接口）删除一个组织</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>DELETE /auth/manage/organization/&lt;组织id&gt;/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null</p>
</div>
</div>
<div class="sect3">
<h4 id="true--55"><a class="anchor" href="#true--55"></a>8.6.29. （管理接口）启用一个组织</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/organization/&lt;组织id&gt;/enable/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null</p>
</div>
</div>
<div class="sect3">
<h4 id="true--56"><a class="anchor" href="#true--56"></a>8.6.30. （管理接口）禁用一个组织</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/organization/&lt;组织id&gt;/disable/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null</p>
</div>
</div>
<div class="sect3">
<h4 id="true--57"><a class="anchor" href="#true--57"></a>8.6.31. （管理接口）导出组织列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/organization/export/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>组织中可导出字段的列表，格式为逗号分割符</p>
</div>
</div>
<div class="sect3">
<h4 id="true--58"><a class="anchor" href="#true--58"></a>8.6.32. （管理接口）上传组织图标</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>POST /auth/manage/organization/res/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>body 上传的图标</p>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>上传图标的uri</p>
</div>
</div>
<div class="sect3">
<h4 id="true--59"><a class="anchor" href="#true--59"></a>8.6.33. （管理接口）获取组织图标</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET &lt;`（管理接口）上传组织图标`中返回的uri&gt;?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>显示上传的图标</p>
</div>
</div>
<div class="sect3">
<h4 id="true--60"><a class="anchor" href="#true--60"></a>8.6.34. （管理接口）添加角色</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>POST /auth/manage/role/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>body</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "flag": String,  // 角色标识
  "name": String, // 角色名称
  "resource_codes": List[String], // 所属资源编码列表
  "organization_code": String // 所属组织编码
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "id": String,  // 数据库id
  "code": String,  // 编码编码
  "flag": String,  // 角色标识
  "name": String, // 角色名称
  "resource_codes": List[String], // 所属资源编码列表
  "organization_code": String, // 所属组织编码
  "enable": Boolean, // 是否启用
  "create_user": String, // 创建用户login_id
  "create_org": String, // 创建角色编码
  "create_time": Long, // 创建时间（yyyyMMddHHmmssSSS）
  "update_user": String, // 更新用户login_id
  "update_org": String, // 更新角色编码
  "update_time": Long // 更新时间（yyyyMMddHHmmssSSS）
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--61"><a class="anchor" href="#true--61"></a>8.6.35. （管理接口）更新角色</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>PUT /auth/manage/role/&lt;角色id&gt;/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>body</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "name": String, // 角色名称
  "resource_codes": List[String], // 所属资源编码列表
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
只能修改<code>name</code>和<code>resource_codes</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>同<code>（管理接口）添加角色</code>的响应内容主体</p>
</div>
</div>
<div class="sect3">
<h4 id="true--62"><a class="anchor" href="#true--62"></a>8.6.36. （管理接口）查找角色列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/role/?__ez_token__=&lt;token&gt;&amp;condition=&lt;查找条件，sql或mongo json&gt;  condition可选</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">[
  {
   同`（管理接口）添加角色`的响应内容主体
  },
  ...
]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--63"><a class="anchor" href="#true--63"></a>8.6.37. （管理接口）查找启用角色列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/role/enable/?__ez_token__=&lt;token&gt;&amp;condition=&lt;查找条件，sql或mongo json&gt;  condition可选</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>同<code>（管理接口）查找启用角色列表</code>的响应内容主体</p>
</div>
</div>
<div class="sect3">
<h4 id="true--64"><a class="anchor" href="#true--64"></a>8.6.38. （管理接口）分页查找角色列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/role/page/&lt;当前页，从1开始&gt;/&lt;每页显示条数&gt;/?__ez_token__=&lt;token&gt;&amp;condition=&lt;查找条件，sql或mongo json&gt;  condition可选</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "pageNumber":Long, // 当前页，从1开始
  "pageSize":Int, // 每页显示条数
  "pageTotal":Long, // 总共页数
  "recordTotal":Long, // 总共记录数
  // 当前页的实体列表
  "objects":[
    {
     同`（管理接口）添加角色`的响应内容主体
    },
    ...
  ]
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--65"><a class="anchor" href="#true--65"></a>8.6.39. （管理接口）获取一个角色</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/role/&lt;角色id&gt;/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>同<code>（管理接口）添加角色</code>的响应内容主体</p>
</div>
</div>
<div class="sect3">
<h4 id="true--66"><a class="anchor" href="#true--66"></a>8.6.40. （管理接口）删除一个角色</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>DELETE /auth/manage/role/&lt;角色id&gt;/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null</p>
</div>
</div>
<div class="sect3">
<h4 id="true--67"><a class="anchor" href="#true--67"></a>8.6.41. （管理接口）启用一个角色</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/role/&lt;角色id&gt;/enable/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null</p>
</div>
</div>
<div class="sect3">
<h4 id="true--68"><a class="anchor" href="#true--68"></a>8.6.42. （管理接口）禁用一个角色</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/role/&lt;角色id&gt;/disable/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null</p>
</div>
</div>
<div class="sect3">
<h4 id="true--69"><a class="anchor" href="#true--69"></a>8.6.43. （管理接口）导出角色列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/role/export/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>角色中可导出字段的列表，格式为逗号分割符</p>
</div>
</div>
<div class="sect3">
<h4 id="true--70"><a class="anchor" href="#true--70"></a>8.6.44. （管理接口）添加账户</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>POST /auth/manage/account/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>body</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "login_id": String, // 登录id
  "name": String, // 姓名
  "email": String, // email
  "image": String, // 头像URL
  "password": String, // 密码
  "role_codes": List[String], // 角色编码列表
  "organization_code": String, // 所属组织编码
  "ext_id": String, // 扩展Id
  "ext_info": Map[String, Any] // 扩展信息
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "id": String,  // 数据库id
  "code": String,  // 账户编码
  "login_id": String, // 登录id
  "name": String, // 姓名
  "email": String, // email
  "image": String, // 头像URL
  "password": String, // 密码
  "role_codes": List[String], // 角色编码列表
  "organization_code": String, // 所属组织编码
  "oauth": Map[String, String], // oauth信息
  "ext_id": String, // 扩展Id
  "ext_info": Map[String, Any] // 扩展信息
  "enable": Boolean, // 是否启用
  "create_user": String, // 创建用户login_id
  "create_org": String, // 创建账户编码
  "create_time": Long, // 创建时间（yyyyMMddHHmmssSSS）
  "update_user": String, // 更新用户login_id
  "update_org": String, // 更新账户编码
  "update_time": Long // 更新时间（yyyyMMddHHmmssSSS）
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--71"><a class="anchor" href="#true--71"></a>8.6.45. （管理接口）更新账户</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>PUT /auth/manage/account/&lt;账户id&gt;/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>body</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "name": String, // 姓名
  "email": String, // email
  "image": String, // 头像URL
  "password": String, // 密码
  "role_codes": List[String], // 角色编码列表
  "ext_info": Map[String, Any] // 扩展信息
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
只能修改<code>name</code>、<code>email</code>、<code>image</code>、<code>password</code>、<code>role_codes</code>和<code>ext_info</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>同<code>（管理接口）添加账户</code>的响应内容主体</p>
</div>
</div>
<div class="sect3">
<h4 id="true--72"><a class="anchor" href="#true--72"></a>8.6.46. （管理接口）查找账户列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/account/?__ez_token__=&lt;token&gt;&amp;condition=&lt;查找条件，sql或mongo json&gt;  condition可选</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">[
  {
   同`（管理接口）添加账户`的响应内容主体
  },
  ...
]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--73"><a class="anchor" href="#true--73"></a>8.6.47. （管理接口）查找启用账户列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/account/enable/?__ez_token__=&lt;token&gt;&amp;condition=&lt;查找条件，sql或mongo json&gt;  condition可选</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>同<code>（管理接口）查找启用账户列表</code>的响应内容主体</p>
</div>
</div>
<div class="sect3">
<h4 id="true--74"><a class="anchor" href="#true--74"></a>8.6.48. （管理接口）分页查找账户列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/account/page/&lt;当前页，从1开始&gt;/&lt;每页显示条数&gt;/?__ez_token__=&lt;token&gt;&amp;condition=&lt;查找条件，sql或mongo json&gt;  condition可选</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "pageNumber":Long, // 当前页，从1开始
  "pageSize":Int, // 每页显示条数
  "pageTotal":Long, // 总共页数
  "recordTotal":Long, // 总共记录数
  // 当前页的实体列表
  "objects":[
    {
     同`（管理接口）添加账户`的响应内容主体
    },
    ...
  ]
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--75"><a class="anchor" href="#true--75"></a>8.6.49. （管理接口）获取一个账户</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/account/&lt;账户id&gt;/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>同<code>（管理接口）添加账户</code>的响应内容主体</p>
</div>
</div>
<div class="sect3">
<h4 id="true--76"><a class="anchor" href="#true--76"></a>8.6.50. （管理接口）删除一个账户</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>DELETE /auth/manage/account/&lt;账户id&gt;/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null</p>
</div>
</div>
<div class="sect3">
<h4 id="true--77"><a class="anchor" href="#true--77"></a>8.6.51. （管理接口）启用一个账户</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/account/&lt;账户id&gt;/enable/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null</p>
</div>
</div>
<div class="sect3">
<h4 id="true--78"><a class="anchor" href="#true--78"></a>8.6.52. （管理接口）禁用一个账户</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/account/&lt;账户id&gt;/disable/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null</p>
</div>
</div>
<div class="sect3">
<h4 id="true--79"><a class="anchor" href="#true--79"></a>8.6.53. （管理接口）导出账户列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/account/export/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>账户中可导出字段的列表，格式为逗号分割符</p>
</div>
</div>
<div class="sect3">
<h4 id="true--80"><a class="anchor" href="#true--80"></a>8.6.54. （管理接口）上传账户头像</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>POST /auth/manage/role/res/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>body 上传的头像</p>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>上传头像的uri</p>
</div>
</div>
<div class="sect3">
<h4 id="true--81"><a class="anchor" href="#true--81"></a>8.6.55. （管理接口）获取账户头像</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET &lt;`（管理接口）上传账户头像`中返回的uri&gt;?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>显示上传的头像</p>
</div>
</div>
<div class="sect3">
<h4 id="true--82"><a class="anchor" href="#true--82"></a>8.6.56. （管理接口）添加菜单</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>POST /auth/manage/menu/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>body</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "uri": String, // 菜单点击的URI
  "name": String, // 菜单名称
  "icon": String, // 菜单图标名称
  "translate": String, // 菜单翻译（i18n用）
  "role_codes": List[String], // 所属角色编码列表
  "parent_code": String, // 父菜单编码，用于多级菜单
  "sort": Int, // 排序，倒序
  "organization_code": String // 所属组织编码
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "id": String,  // 数据库id
  "code": String,  // 菜单编码
  "uri": String, // 菜单点击的URI
  "name": String, // 菜单名称
  "icon": String, // 菜单图标名称
  "translate": String, // 菜单翻译（i18n用）
  "role_codes": List[String], // 所属角色编码列表
  "parent_code": String, // 父菜单编码，用于多级菜单
  "sort": Int, // 排序，倒序
  "organization_code": String, // 所属组织编码
  "enable": Boolean, // 是否启用
  "create_user": String, // 创建用户login_id
  "create_org": String, // 创建菜单编码
  "create_time": Long, // 创建时间（yyyyMMddHHmmssSSS）
  "update_user": String, // 更新用户login_id
  "update_org": String, // 更新菜单编码
  "update_time": Long // 更新时间（yyyyMMddHHmmssSSS）
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--83"><a class="anchor" href="#true--83"></a>8.6.57. （管理接口）更新菜单</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>PUT /auth/manage/menu/&lt;菜单id&gt;/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>body</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "name": String, // 菜单名称
  "icon": String, // 菜单图标名称
  "translate": String, // 菜单翻译（i18n用）
  "role_codes": List[String], // 所属角色编码列表
  "parent_code": String, // 父菜单编码，用于多级菜单
  "sort": Int // 排序，倒序
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
只能修改<code>name</code>、<code>icon</code>、<code>translate</code>、<code>parent_code</code>、<code>role_codes</code>和<code>sort</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>同<code>（管理接口）添加菜单</code>的响应内容主体</p>
</div>
</div>
<div class="sect3">
<h4 id="true--84"><a class="anchor" href="#true--84"></a>8.6.58. （管理接口）查找菜单列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/menu/?__ez_token__=&lt;token&gt;&amp;condition=&lt;查找条件，sql或mongo json&gt;  condition可选</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">[
  {
   同`（管理接口）添加菜单`的响应内容主体
  },
  ...
]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--85"><a class="anchor" href="#true--85"></a>8.6.59. （管理接口）查找启用菜单列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/menu/enable/?__ez_token__=&lt;token&gt;&amp;condition=&lt;查找条件，sql或mongo json&gt;  condition可选</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>同<code>（管理接口）查找启用菜单列表</code>的响应内容主体</p>
</div>
</div>
<div class="sect3">
<h4 id="true--86"><a class="anchor" href="#true--86"></a>8.6.60. （管理接口）分页查找菜单列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/menu/page/&lt;当前页，从1开始&gt;/&lt;每页显示条数&gt;/?__ez_token__=&lt;token&gt;&amp;condition=&lt;查找条件，sql或mongo json&gt;  condition可选</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text" data-lang="text">{
  "pageNumber":Long, // 当前页，从1开始
  "pageSize":Int, // 每页显示条数
  "pageTotal":Long, // 总共页数
  "recordTotal":Long, // 总共记录数
  // 当前页的实体列表
  "objects":[
    {
     同`（管理接口）添加菜单`的响应内容主体
    },
    ...
  ]
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--87"><a class="anchor" href="#true--87"></a>8.6.61. （管理接口）获取一个菜单</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/menu/&lt;菜单id&gt;/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>同<code>（管理接口）添加菜单</code>的响应内容主体</p>
</div>
</div>
<div class="sect3">
<h4 id="true--88"><a class="anchor" href="#true--88"></a>8.6.62. （管理接口）删除一个菜单</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>DELETE /auth/manage/menu/&lt;菜单id&gt;/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null</p>
</div>
</div>
<div class="sect3">
<h4 id="true--89"><a class="anchor" href="#true--89"></a>8.6.63. （管理接口）启用一个菜单</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/menu/&lt;菜单id&gt;/enable/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null</p>
</div>
</div>
<div class="sect3">
<h4 id="true--90"><a class="anchor" href="#true--90"></a>8.6.64. （管理接口）禁用一个菜单</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/menu/&lt;菜单id&gt;/disable/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>null</p>
</div>
</div>
<div class="sect3">
<h4 id="true--91"><a class="anchor" href="#true--91"></a>8.6.65. （管理接口）导出菜单列表</h4>
<div class="paragraph">
<p><strong>请求</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /auth/manage/menu/export/?__ez_token__=&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>响应内容主体</strong></p>
</div>
<div class="paragraph">
<p>菜单中可导出字段的列表，格式为逗号分割符</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--92"><a class="anchor" href="#true--92"></a>9. 邮件服务</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="true--93"><a class="anchor" href="#true--93"></a>9.1. 功能</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>支持同步或异步的邮件发送服务</p>
</li>
<li>
<p>支持添加附件</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true5-4"><a class="anchor" href="#true5-4"></a>9.2. 5分钟上手</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>添加依赖</p>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
  &lt;groupId&gt;com.ecfront&lt;/groupId&gt;
  &lt;artifactId&gt;ezf-email&lt;/artifactId&gt;
  &lt;version&gt;3.0.0-SNAPSHOT&lt;/version&gt;
&lt;dependency&gt;</pre>
</div>
</div>
</li>
<li>
<p>添加配置</p>
<div class="literalblock">
<div class="content">
<pre>"email": {
  "hostname": "&lt;SMTP服务IP&gt;",
  "username": "&lt;用户名或完整email 地址&gt;",
  "password": "&lt;登录密码&gt;"
}</pre>
</div>
</div>
</li>
<li>
<p>测试服务</p>
<div class="literalblock">
<div class="content">
<pre>EZManager.start()
EmailProcessor.send(
  "&lt;收件人email地址&gt;",
  "test 1",
  "&lt;h1&gt;h1&lt;/h1&gt;&lt;br/&gt;1\r\n2\r\n"
)</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true--94"><a class="anchor" href="#true--94"></a>9.3. 依赖</h3>
<div class="paragraph">
<p>无</p>
</div>
</div>
<div class="sect2">
<h3 id="true--95"><a class="anchor" href="#true--95"></a>9.4. 配置</h3>
<div class="listingblock">
<div class="content">
<pre>"email": {
  "hostname": "", <i class="conum" data-value="1"></i><b>(1)</b>
  "port": 25, <i class="conum" data-value="2"></i><b>(2)</b>
  "starttls": "OPTIONAL", <i class="conum" data-value="3"></i><b>(3)</b>
  "login": "NONE", <i class="conum" data-value="4"></i><b>(4)</b>
  "username": "", <i class="conum" data-value="5"></i><b>(5)</b>
  "password": "", <i class="conum" data-value="6"></i><b>(6)</b>
  "ssl": false, <i class="conum" data-value="7"></i><b>(7)</b>
  "authMethods": "LOGIN", <i class="conum" data-value="8"></i><b>(8)</b>
  "keepAlive": true, <i class="conum" data-value="9"></i><b>(9)</b>
  "maxPoolSize": 10, <i class="conum" data-value="10"></i><b>(10)</b>
  "trustAll": false, <i class="conum" data-value="11"></i><b>(11)</b>
  "keyStore ": "&lt;可选&gt;", <i class="conum" data-value="12"></i><b>(12)</b>
  "keyStorePassword": "&lt;可选&gt;", <i class="conum" data-value="13"></i><b>(13)</b>
  "allowRcptErrors": "&lt;可选&gt;" <i class="conum" data-value="14"></i><b>(14)</b>
}</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>SMTP服务IP</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>SMTP服务端口号</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>通信协议扩展，支持 DISABLED, OPTIONAL or REQUIRED</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>登录认证，支持 DISABLED, NONE or REQUIRED</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>登录用户名或完整email 地址</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>登录密码</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>是否使用SSL加密连接</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>登录认证方法，可选 或填写 LOGIN</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>是否使用连接池</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>最大连接数量</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>是否信任所有证书</td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>加密证书绝对路径</td>
</tr>
<tr>
<td><i class="conum" data-value="13"></i><b>13</b></td>
<td>证书密码</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="trueqq"><a class="anchor" href="#trueqq"></a>9.4.1. QQ企业邮箱配置示例</h4>
<div class="listingblock">
<div class="content">
<pre>"email": {
  "hostname": "smtp.exmail.qq.com",
  "port": 465,
  "starttls": "REQUIRED",
  "login": "REQUIRED",
  "ssl": true,
  "authMethods": "LOGIN",
  "username": "admin@ecfront.com",
  "password": "&lt;密码&gt;"
}</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="true--96"><a class="anchor" href="#true--96"></a>9.5. 使用</h3>
<div class="sect3">
<h4 id="true--97"><a class="anchor" href="#true--97"></a>9.5.1. 同步操作</h4>
<div class="listingblock">
<div class="title">EmailProcessor</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">/**
    * 发送email
    *
    * @param to      to
    * @param title   标题
    * @param content 正文
    * @return 发送结果
    */
  def send(to: String, title: String, content: String): Resp[Void]

  /**
    * 发送email
    *
    * @param to      to
    * @param title   标题
    * @param content 正文
    * @return 发送结果
    */
  def send(to: List[String], title: String, content: String): Resp[Void] = {
    send(mailConfig.getUsername, to, null, null, title, content, List())
  }

  /**
    * 发送email
    *
    * @param from    from
    * @param to      to
    * @param title   标题
    * @param content 正文
    * @return 发送结果
    */
  def send(from: String, to: String, title: String, content: String): Resp[Void]

  /**
    * 发送email
    *
    * @param from    from
    * @param to      to
    * @param title   标题
    * @param content 正文
    * @return 发送结果
    */
  def send(from: String, to: List[String], title: String, content: String): Resp[Void]

  /**
    * 发送email
    *
    * @param from        from
    * @param to          to
    * @param cc          cc
    * @param bcc         bcc
    * @param title       标题
    * @param content     正文
    * @param attachments 附件，格式：Name - ContentType -  Data
    * @return 发送结果
    */
  def send(from: String, to: List[String], cc: List[String], bcc: List[String],
           title: String, content: String, attachments: List[(String, String, Buffer)]): Resp[Void]</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="true--98"><a class="anchor" href="#true--98"></a>异步操作</h5>
<div class="listingblock">
<div class="title">EmailProcessor.Async</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">   /**
      * 发送email
      *
      * @param to      to
      * @param title   标题
      * @param content 正文
      * @return 发送结果
      */
    def send(to: String, title: String, content: String): Future[Resp[Void]]

    /**
      * 发送email
      *
      * @param to      to
      * @param title   标题
      * @param content 正文
      * @return 发送结果
      */
    def send(to: List[String], title: String, content: String): Future[Resp[Void]]

    /**
      * 发送email
      *
      * @param from    from
      * @param to      to
      * @param title   标题
      * @param content 正文
      * @return 发送结果
      */
    def send(from: String, to: String, title: String, content: String): Future[Resp[Void]]

    /**
      * 发送email
      *
      * @param from    from
      * @param to      to
      * @param title   标题
      * @param content 正文
      * @return 发送结果
      */
    def send(from: String, to: List[String], title: String, content: String): Future[Resp[Void]]

    /**
      * 发送email
      *
      * @param from        from
      * @param to          to
      * @param cc          cc
      * @param bcc         bcc
      * @param title       标题
      * @param content     正文
      * @param attachments 附件，格式：Name - ContentType -  Data
      * @return 发送结果
      */
    def send(from: String, to: List[String], cc: List[String], bcc: List[String],
             title: String, content: String, attachments: List[(String, String, Buffer)]): Future[Resp[Void]]</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="trueredis"><a class="anchor" href="#trueredis"></a>10. Redis服务</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="true--99"><a class="anchor" href="#true--99"></a>10.1. 功能</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>支持Redis的常用操作</p>
</li>
<li>
<p>支持同步与异步操作</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true5-5"><a class="anchor" href="#true5-5"></a>10.2. 5分钟上手</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>添加依赖</p>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
  &lt;groupId&gt;com.ecfront&lt;/groupId&gt;
  &lt;artifactId&gt;ezf-redis&lt;/artifactId&gt;
  &lt;version&gt;3.0.0-SNAPSHOT&lt;/version&gt;
&lt;dependency&gt;</pre>
</div>
</div>
</li>
<li>
<p>添加配置</p>
<div class="literalblock">
<div class="content">
<pre>"distributed": {},
"redis": {
  "host": "&lt;redis IP&gt;"
}</pre>
</div>
</div>
</li>
<li>
<p>测试服务</p>
<div class="literalblock">
<div class="content">
<pre>EZManager.start()
// 删除n_test
RedisProcessor.del("n_test")
// 判断是否存在n_test
RedisProcessor.exists("n_test")
// 添加n_test值 4秒后过期
RedisProcessor.set("n_test", s"""{"name":"jzy"}""", 4)
// 获取n_test值
RedisProcessor.get("n_test")</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true--100"><a class="anchor" href="#true--100"></a>10.3. 依赖</h3>
<div class="paragraph">
<p>环境依赖：redis 3.x</p>
</div>
</div>
<div class="sect2">
<h3 id="true--101"><a class="anchor" href="#true--101"></a>10.4. 配置</h3>
<div class="listingblock">
<div class="content">
<pre>"redis": {
  "host": "127.0.0.1", <i class="conum" data-value="1"></i><b>(1)</b>
  "port": 6379, <i class="conum" data-value="2"></i><b>(2)</b>
  "auth": null, <i class="conum" data-value="3"></i><b>(3)</b>
  "db": 0, <i class="conum" data-value="4"></i><b>(4)</b>
}</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Redis服务IP</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Redis服务端口号</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Redis认证密码</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>连接的db库名</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="true--102"><a class="anchor" href="#true--102"></a>10.5. 使用</h3>
<div class="sect3">
<h4 id="true--103"><a class="anchor" href="#true--103"></a>10.5.1. 同步操作</h4>
<div class="listingblock">
<div class="title">RedisProcessor</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">   /**
    * 暴露redis client ，用于自定义操作
    *
    * @return redis client
    */
  def custom(): RedisClient

  /**
    * key是否存在
    *
    * @param key key
    * @return 是否存在
    */
  def exists(key: String): Resp[Boolean]

  /**
    * 获取字符串值
    *
    * @param key key
    * @return 字符串值
    */
  def get(key: String): Resp[String]

  /**
    * 设置字符串
    *
    * @param key    key
    * @param value  value
    * @param expire 过期时间(seconds)，0表示永不过期
    * @return 是否成功
    */
  def set(key: String, value: String, expire: Long = 0): Resp[Void]

  /**
    * 删除key
    *
    * @param key key
    * @return 是否成功
    */
  def del(key: String): Resp[Void]

  /**
    * 设置列表
    *
    * @param key    key
    * @param values values
    * @param expire 过期时间(seconds)，0表示永不过期
    * @return 是否成功
    */
  def lmset(key: String, values: List[String], expire: Long = 0): Resp[Void]

  /**
    * 添加列表值
    *
    * @param key   key
    * @param value value
    * @return 是否成功
    */
  def lpush(key: String, value: String): Resp[Void]

  /**
    * 修改列表中索引对应的值
    *
    * @param key   key
    * @param value value
    * @param index 索引
    * @return 是否成功
    */
  def lset(key: String, value: String, index: Long): Resp[Void]

  /**
    * 弹出栈顶的列表值
    * 注意，Redis的列表是栈结构，先进后出
    *
    * @param key key
    * @return 栈顶的列表值
    */
  def lpop(key: String): Resp[String]

  /**
    * 获取列表中索引对应的值
    * 注意，Redis的列表是栈结构，先进后出
    *
    * @param key   key
    * @param index 索引
    * @return 索引对应的值
    */
  def lindex(key: String, index: Long): Resp[String]

  /**
    * 获取列表值的长度
    *
    * @param key key
    * @return 长度
    */
  def llen(key: String): Resp[Long]

  /**
    * 获取列表中的所有值
    *
    * @param key key
    * @return 值列表
    */
  def lget(key: String): Resp[List[String]]

  /**
    * 设置Hash集合
    *
    * @param key    key
    * @param values values
    * @param expire 过期时间(seconds)，0表示永不过期
    * @return 是否成功
    */
  def hmset(key: String, values: Map[String, String], expire: Long = 0): Resp[Void]

  /**
    * 修改Hash集合field对应的值
    *
    * @param key   key
    * @param field field
    * @param value value
    * @return 是否成功
    */
  def hset(key: String, field: String, value: String): Resp[Void]

  /**
    * 获取Hash集合field对应的值
    *
    * @param key   key
    * @param field field
    * @return field对应的值
    */
  def hget(key: String, field: String): Resp[String]

  /**
    * 判断Hash集合field是否存在
    *
    * @param key   key
    * @param field field
    * @return 是否存在
    */
  def hexists(key: String, field: String): Resp[Boolean]

  /**
    * 获取Hash集合的所有值
    *
    * @param key key
    * @return 所有值
    */
  def hgetall(key: String): Resp[Map[String, String]]

  /**
    * 删除Hash集合是对应的field
    *
    * @param key   key
    * @param field field
    * @return 是否成功
    */
  def hdel(key: String, field: String): Resp[Void]

  /**
    * 原子加操作
    *
    * @param key       key，key不存在时会自动创建值为0的对象
    * @param incrValue 要增加的值，必须是Long Int Float 或 Double
    * @return 是否成功
    */
  def incr(key: String, incrValue: Any): Resp[Void]

  /**
    * 原子减操作
    *
    * @param key       key key，key不存在时会自动创建值为0的对象
    * @param decrValue 要减少的值，必须是Long  或 Int
    * @return 是否成功
    */
  def decr(key: String, decrValue: Any): Resp[Void]</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="true--104"><a class="anchor" href="#true--104"></a>异步操作</h5>
<div class="listingblock">
<div class="title">RedisProcessor.Async</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">    /**
      * key是否存在
      *
      * @param key key
      * @return 是否存在
      */
    def exists(key: String): Future[Resp[Boolean]]

    /**
      * 获取字符串值
      *
      * @param key key
      * @return 字符串值
      */
    def get(key: String): Future[Resp[String]]

    /**
      * 设置字符串
      *
      * @param key    key
      * @param value  value
      * @param expire 过期时间(seconds)，0表示永不过期
      * @return 是否成功
      */
    def set(key: String, value: String, expire: Long = 0): Future[Resp[Void]]

    /**
      * 删除key
      *
      * @param key key
      * @return 是否成功
      */
    def del(key: String): Future[Resp[Void]]

    /**
      * 设置列表
      *
      * @param key    key
      * @param values values
      * @param expire 过期时间(seconds)，0表示永不过期
      * @return 是否成功
      */
    def lmset(key: String, values: List[String], expire: Long = 0): Future[Resp[Void]]

    /**
      * 添加列表值
      *
      * @param key   key
      * @param value value
      * @return 是否成功
      */
    def lpush(key: String, value: String): Future[Resp[Void]]

    /**
      * 修改列表中索引对应的值
      *
      * @param key   key
      * @param value value
      * @param index 索引
      * @return 是否成功
      */
    def lset(key: String, value: String, index: Long): Future[Resp[Void]]

    /**
      * 弹出栈顶的列表值
      * 注意，Redis的列表是栈结构，先进后出
      *
      * @param key key
      * @return 栈顶的列表值
      */
    def lpop(key: String): Future[Resp[String]]

    /**
      * 获取列表中索引对应的值
      * 注意，Redis的列表是栈结构，先进后出
      *
      * @param key   key
      * @param index 索引
      * @return 索引对应的值
      */
    def lindex(key: String, index: Long): Future[Resp[String]]

    /**
      * 获取列表值的长度
      *
      * @param key key
      * @return 长度
      */
    def llen(key: String): Future[Resp[Long]]

    /**
      * 获取列表中的所有值
      *
      * @param key key
      * @return 值列表
      */
    def lget(key: String): Future[Resp[List[String]]]

    /**
      * 设置Hash集合
      *
      * @param key    key
      * @param values values
      * @param expire 过期时间(seconds)，0表示永不过期
      * @return 是否成功
      */
    def hmset(key: String, values: Map[String, String], expire: Long = 0): Future[Resp[Void]]

    /**
      * 修改Hash集合field对应的值
      *
      * @param key   key
      * @param field field
      * @param value value
      * @return 是否成功
      */
    def hset(key: String, field: String, value: String): Future[Resp[Void]]

    /**
      * 获取Hash集合field对应的值
      *
      * @param key   key
      * @param field field
      * @return field对应的值
      */
    def hget(key: String, field: String): Future[Resp[String]]

    /**
      * 判断Hash集合field是否存在
      *
      * @param key   key
      * @param field field
      * @return 是否存在
      */
    def hexists(key: String, field: String): Future[Resp[Boolean]]

    /**
      * 获取Hash集合的所有值
      *
      * @param key key
      * @return 所有值
      */
    def hgetall(key: String): Future[Resp[Map[String, String]]]

    /**
      * 删除Hash集合是对应的field
      *
      * @param key   key
      * @param field field
      * @return 是否成功
      */
    def hdel(key: String, field: String): Future[Resp[Void]]

    /**
      * 原子加操作
      *
      * @param key       key，key不存在时会自动创建值为0的对象
      * @param incrValue 要增加的值，必须是Long Int Float 或 Double
      * @return 是否成功
      */
    def incr(key: String, incrValue: Any): Future[Resp[Void]]

    /**
      * 原子减操作
      *
      * @param key       key key，key不存在时会自动创建值为0的对象
      * @param decrValue 要减少的值，必须是Long  或 Int
      * @return 是否成功
      */
    def decr(key: String, decrValue: Any): Future[Resp[Void]]</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--105"><a class="anchor" href="#true--105"></a>11. 常用分布式服务</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="true--106"><a class="anchor" href="#true--106"></a>11.1. 功能</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>分布式计数</p>
</li>
<li>
<p>分布式锁</p>
</li>
<li>
<p>分布式Map</p>
</li>
<li>
<p>分布式阻塞和非阻塞队列</p>
</li>
<li>
<p>分布式消息发布订阅</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true5-6"><a class="anchor" href="#true5-6"></a>11.2. 5分钟上手</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>添加依赖</p>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
  &lt;groupId&gt;com.ecfront&lt;/groupId&gt;
  &lt;artifactId&gt;ezf-distributed&lt;/artifactId&gt;
  &lt;version&gt;3.0.0-SNAPSHOT&lt;/version&gt;
&lt;dependency&gt;</pre>
</div>
</div>
</li>
<li>
<p>添加配置</p>
<div class="literalblock">
<div class="content">
<pre>"distributed": {},
"redis": {}</pre>
</div>
</div>
</li>
<li>
<p>测试服务</p>
<div class="literalblock">
<div class="content">
<pre>EZManager.start()
// 创建test_counter计数器
val counter = DCounterService("test_counter")
// 设置成10
counter.set(10)
// 加1
counter.inc()
// 减1
counter.dec()
// 删除
counter.delete()</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true--107"><a class="anchor" href="#true--107"></a>11.3. 依赖</h3>
<div class="paragraph">
<p>服务依赖：redis</p>
</div>
</div>
<div class="sect2">
<h3 id="true--108"><a class="anchor" href="#true--108"></a>11.4. 配置</h3>
<div class="listingblock">
<div class="content">
<pre>"distributed": {}</pre>
</div>
</div>
<div class="paragraph">
<p><em>分布式服务本身没有配置项</em></p>
</div>
</div>
<div class="sect2">
<h3 id="true--109"><a class="anchor" href="#true--109"></a>11.5. 使用</h3>
<div class="sect3">
<h4 id="true-atomiclong"><a class="anchor" href="#true-atomiclong"></a>11.5.1. 分布式AtomicLong</h4>
<div class="listingblock">
<div class="title">DAtomicLongService(key: String) &lt;1&gt;</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">  def set(value: Long)
  def get: Long</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>key AtomicLong名</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="true--110"><a class="anchor" href="#true--110"></a>11.5.2. 分布式阻塞队列</h4>
<div class="listingblock">
<div class="title">DBlockingQueueService[M](key: String) &lt;1&gt;</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">  def put(value: M)
  def peek(): M
  def take(): M
  def size(): Int
  def delete()</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>key 队列名,M 队列项的类型</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="true-countdownlatch"><a class="anchor" href="#true-countdownlatch"></a>11.5.3. 分布式CountDownLatch</h4>
<div class="listingblock">
<div class="title">DCountDownLatchService(key: String) &lt;1&gt;</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">  def set(value: Long)
  def await(time: Long = -1, unit: TimeUnit = null)
  def get: Long
  def countDown()
  def delete()</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>key CountDownLatch名</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="true--111"><a class="anchor" href="#true--111"></a>11.5.4. 分布式原子计数器</h4>
<div class="listingblock">
<div class="title">DCounterService(key: String) &lt;1&gt;</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">  def set(value: Long)
  def get: Long
  def inc(): Long
  def dec(): Long

  /**
    * 有上限的inc
    *
    * @param maxValue 最大值
    * @return 当前值
    */
  def inc(maxValue: Long): Long

  /**
    * 有上限的inc并返回是否增加了
    *
    * @param maxValue 最大值
    * @return 是否增加了，已达上限返回false
    */
  def incWithStatus(maxValue: Long): Boolean

  /**
    * 有下限的dec
    *
    * @param minValue 最小值
    * @return 当前值
    */
  def dec(minValue: Long): Long

  /**
    * 有下限的inc并返回是否减少了
    *
    * @param minValue 最小值
    * @return 是否减少了，已达下限返回false
    */
  def decWithStatus(minValue: Long): Boolean

  def delete()</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>key 计数器名</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="true--112"><a class="anchor" href="#true--112"></a>11.5.5. 分布式锁</h4>
<div class="listingblock">
<div class="title">DLockService(key: String) &lt;1&gt;</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">  def lock(leaseTime: Long = -1, unit: TimeUnit = null)
  def tryLock(waitTime: Long = 0, leaseTime: Long = -1, unit: TimeUnit = TimeUnit.MILLISECONDS): Boolean
  def unLock(): Boolean
  def isLock: Boolean
  def delete()</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>key 锁名</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="true-map-key-string-value"><a class="anchor" href="#true-map-key-string-value"></a>11.5.6. 分布式Map，key为string , value为自定义类型</h4>
<div class="listingblock">
<div class="title">DMapService[M](key: String) &lt;1&gt;</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">  def put(key: String, value: M)
  def putIfAbsent(key: String, value: M)
  def contains(key: String): Boolean
  def foreach(fun: (String, M) =&gt; Unit)
  def get(key: String): M
  def remove(key: String)
  def clear()</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>key Map名,M Map项的类型</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="true--113"><a class="anchor" href="#true--113"></a>11.5.7. 分布式队列（不阻塞）</h4>
<div class="listingblock">
<div class="title">DQueueService[M](key: String) &lt;1&gt;</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">  def add(value: M)
  def peek(): M
  def poll(): M
  def size(): Int
  def delete()</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>key 队列名,M 队列项的类型</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="true--114"><a class="anchor" href="#true--114"></a>11.5.8. 分布式消息队列</h4>
<div class="listingblock">
<div class="title">DTopicService[M](key: String) &lt;1&gt;</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">  def publish(message: M)
  def subscribe(fun: =&gt; M =&gt; Unit)</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>key 消息队列名,M 消息队列项的类型</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--115"><a class="anchor" href="#true--115"></a>12. 调度服务</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="true--116"><a class="anchor" href="#true--116"></a>12.1. 功能</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>支持cron表达式的调度任务</p>
</li>
<li>
<p>支持按模块调度</p>
</li>
<li>
<p>支持JDBC或Mongo的持久化</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true5-7"><a class="anchor" href="#true5-7"></a>12.2. 5分钟上手</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>添加依赖</p>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
  &lt;groupId&gt;com.ecfront&lt;/groupId&gt;
  &lt;artifactId&gt;ezf-scheduler&lt;/artifactId&gt;
  &lt;version&gt;3.0.0-SNAPSHOT&lt;/version&gt;
&lt;dependency&gt;</pre>
</div>
</div>
</li>
<li>
<p>添加配置</p>
<div class="literalblock">
<div class="content">
<pre>"scheduler":{
   "storage":"mongo"
}</pre>
</div>
</div>
</li>
<li>
<p>添加调度代码</p>
<div class="literalblock">
<div class="content">
<pre>// 添加调度任务
val scheduler = EZ_Scheduler()
scheduler.name = "测试" // 任务名称
scheduler.cron = "* * * * * ?" // 调度周期
scheduler.module = EZContext.module // 要调度的模块
scheduler.clazz = TestScheduleJob.getClass.getName // 任务回调对应的类
scheduler.parameters = Map("p1" -&gt; 1, "p2" -&gt; "1") // 任务参数
SchedulerProcessor.save(scheduler) // 保存</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>object TestScheduleJob extends ScheduleJob {
  override def execute(scheduler: EZ_Scheduler): Resp[Void] = {
    println("Scheduler callback:" + scheduler.name)
    Resp.success(null)
  }
}</pre>
</div>
</div>
</li>
<li>
<p>启动服务</p>
<div class="literalblock">
<div class="content">
<pre>EZManager.start()</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true--117"><a class="anchor" href="#true--117"></a>12.3. 依赖</h3>
<div class="paragraph">
<p>服务依赖：storage.mongo或storage.jdbc</p>
</div>
<div class="paragraph">
<p>环境依赖：mongo或mysql</p>
</div>
</div>
<div class="sect2">
<h3 id="true--118"><a class="anchor" href="#true--118"></a>12.4. 配置</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">"scheduler": {
  "storage": "" <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>持久化实现，支持<code>mongo</code>或<code>jdbc</code></td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>storage:jdbc</code>时请执行<code>ez_ddl.sql</code>以创建基础表
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="true--119"><a class="anchor" href="#true--119"></a>12.5. 使用</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">=== 保存调度任务 ===

// 调度任务是EZ_Scheduler对象
val scheduler = EZ_Scheduler()
scheduler.name = "" // 任务名称
scheduler.cron = "" // 调度周期
scheduler.module = "" // 要调度的模块
scheduler.clazz = "" // 任务回调对应的类，要实现ScheduleJob接口
scheduler.parameters = Map() // 任务参数
SchedulerProcessor.save(scheduler) // 保存

=== 更新调度任务 ===
...
SchedulerProcessor.update(scheduler)
...

=== 删除调度任务 ===
...
SchedulerProcessor.delete("&lt;调度任务名称&gt;")
...

=== 根据调度名称分页获取日志 ===
...
SchedulerProcessor.pageLogsByName("&lt;调度任务名称&gt;", &lt;当前页，从1开始&gt;, &lt;每页条数&gt;)
...

=== 调度任务回调 ===

/**
  * 调度器回调基类，所有调度作业回调处理都要继承此类
  */
trait ScheduleJob {

  /**
    * 调度器回调时的执行方法
    *
    * @param scheduler 调度信息
    * @return 执行结果
    */
  def execute(scheduler: EZ_Scheduler): Resp[Void]

}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truekafka"><a class="anchor" href="#truekafka"></a>13. Kafka服务</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="true--120"><a class="anchor" href="#true--120"></a>13.1. 功能</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>实现Kafka服务封装</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true5-8"><a class="anchor" href="#true5-8"></a>13.2. 5分钟上手</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>添加依赖</p>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
  &lt;groupId&gt;com.ecfront&lt;/groupId&gt;
  &lt;artifactId&gt;ezf-kafka&lt;/artifactId&gt;
  &lt;version&gt;3.0.0-SNAPSHOT&lt;/version&gt;
&lt;dependency&gt;</pre>
</div>
</div>
</li>
<li>
<p>添加配置</p>
<div class="literalblock">
<div class="content">
<pre>"kafka": {
  "brokerList": "&lt;broker ip:port&gt;",
  "zkList": "&lt;zookeeper ip:port&gt;"
}</pre>
</div>
</div>
</li>
<li>
<p>测试服务</p>
<div class="literalblock">
<div class="content">
<pre>EZManager.start()
// 定义第一个消费者，属于group1
val consumer1 = KafkaProcessor.Consumer("group1", "topic1")
consumer1.receive(new ReceivedCallback {
  override def callback(message: String): Resp[Void] = {
    // 收到消息
    println("consumer1 -&gt; " + message)
    // 关闭此消费者，这时第二个消费者可以收到消息
    consumer1.close()
    Resp.success(null)
  }
})
// 定义第二个消费者，也属于group1，第一个与第二消费者是竞争关系，同一消息只会被其中一个消 费
KafkaProcessor.Consumer("group1", "topic1").receive(new ReceivedCallback {
  override def callback(message: String): Resp[Void] = {
    // 收到消息
    println("consumer2 -&gt; " + message)
    Resp.success(null)
  }
})
// 定义第三个消费者，属于group2，这个消费者可以收到所有消息
KafkaProcessor.Consumer("group2", "topic1").receive(new ReceivedCallback {
  override def callback(message: String): Resp[Void] = {
    // 收到消息
    println("consumer3 -&gt; " + message)
    Resp.success(null)
  }
})
// 定义一个生产者
val producer = KafkaProcessor.Producer("topic1", "client1")
for (i &lt;- 0 to 5) {
  producer.send(s"【$i】haha...")
}</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true--121"><a class="anchor" href="#true--121"></a>13.3. 依赖</h3>
<div class="paragraph">
<p>环境依赖：kafka 0.8.x</p>
</div>
</div>
<div class="sect2">
<h3 id="true--122"><a class="anchor" href="#true--122"></a>13.4. 配置</h3>
<div class="listingblock">
<div class="content">
<pre>"kafka": {
  "brokerList": "", <i class="conum" data-value="1"></i><b>(1)</b>
  "zkList": "" <i class="conum" data-value="2"></i><b>(2)</b>
}</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Kafka broker地址列表，格式为: ip:port,&#8230;&#8203;</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Zookeeper地址列表，格式为: ip:port,&#8230;&#8203;</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="true--123"><a class="anchor" href="#true--123"></a>13.5. 使用</h3>
<div class="paragraph">
<p>见示例<code>com.ecfront.ez.framework.examples.kafka</code></p>
</div>
</div>
<div class="sect2">
<h3 id="trueapi"><a class="anchor" href="#trueapi"></a>13.6. API</h3>
<div class="listingblock">
<div class="title">KafkaProcessor</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">  /**
  * 生产者类
  *
  * @param topic    主题
  * @param clientId 客户端ID
  */
case class Producer(topic: String, clientId: String) {

  /**
    * 发送消息
    *
    * @param message 消息
    */
  def send(message: String): Unit

  /**
    * 发送消息
    *
    * @param message 消息
    * @return 是否成功 ,返回对应的消息ID（自动生成）和message
    */
  def sendFuture(message: String): Future[Resp[(String, String)]]

	/**
    * 关闭当前生产者
    */
  def close(): Unit

}

/**
  * 消费者类
  *
  * @param groupId            组ID，用于发布-订阅模式
  * @param topic              主题
  * @param autoCommit         是否自动提交
  * @param autoCommitInterval 自动提供间隔
  */
case class Consumer(groupId: String, topic: String, autoCommit: Boolean = false, autoCommitInterval: Long = DEFAULT_AUTO_COMMIT_INTERVAL) {

/**
    * 接收消息
    *
    * @param fun 收到消息后的回调方法
    */
  def receive(fun: ReceivedCallback): Unit

	/**
    * 关闭当前消费者
    */
  def close(): Unit

}

  /**
  * 关闭所有实例
  */
def close(): Unit</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truemaster-slave"><a class="anchor" href="#truemaster-slave"></a>14. Master-Slave服务</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="true--124"><a class="anchor" href="#true--124"></a>14.1. 功能</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>master-slave模型封装</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true5-9"><a class="anchor" href="#true5-9"></a>14.2. 5分钟上手</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>添加依赖</p>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
  &lt;groupId&gt;com.ecfront&lt;/groupId&gt;
  &lt;artifactId&gt;ezf-master-slave&lt;/artifactId&gt;
  &lt;version&gt;3.0.0-SNAPSHOT&lt;/version&gt;
&lt;dependency&gt;</pre>
</div>
</div>
</li>
<li>
<p>添加配置</p>
<div class="literalblock">
<div class="content">
<pre>"masterslave": {
  "clusterId": "ez.test"
},
"kafka": {
  "brokerList": "&lt;broker ip:port&gt;",
  "zkList": "&lt;zookeeper ip:port&gt;"
}</pre>
</div>
</div>
</li>
<li>
<p>测试服务</p>
<div class="literalblock">
<div class="content">
<pre>EZManager.start()</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true--125"><a class="anchor" href="#true--125"></a>14.3. 依赖</h3>
<div class="paragraph">
<p>服务依赖：kafka、redis(如果需要HA支持)
环境依赖：kafka 0.8.x、redis 3.x</p>
</div>
</div>
<div class="sect2">
<h3 id="true--126"><a class="anchor" href="#true--126"></a>14.4. 配置</h3>
<div class="listingblock">
<div class="content">
<pre>"masterslave": {
  "clusterId": "", <i class="conum" data-value="1"></i><b>(1)</b>
  "ha":false, <i class="conum" data-value="2"></i><b>(2)</b>
  "category": { <i class="conum" data-value="3"></i><b>(3)</b>
    "": { <i class="conum" data-value="4"></i><b>(4)</b>
      "pool": 5, <i class="conum" data-value="5"></i><b>(5)</b>
      "newThread": true <i class="conum" data-value="6"></i><b>(6)</b>
    }
 }</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>集群ID，同一ID的节点会被视为同一集群</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>是否启用HA，启用HA时需要Redis支持</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Worker执行器列表</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Worker执行器名</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>当前执行器并发数</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>当前执行器是否在新线程中执行</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="true--127"><a class="anchor" href="#true--127"></a>14.5. 使用</h3>
<div class="paragraph">
<p>见示例<code>com.ecfront.ez.framework.examples.masterslave</code></p>
</div>
</div>
<div class="sect2">
<h3 id="trueapi-2"><a class="anchor" href="#trueapi-2"></a>14.6. API</h3>
<div class="listingblock">
<div class="title">KafkaProcessor</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala" data-lang="scala">  /**
  * 生产者类
  *
  * @param topic    主题
  * @param clientId 客户端ID
  */
case class Producer(topic: String, clientId: String) {

  /**
    * 发送消息
    *
    * @param message 消息
    */
  def send(message: String): Unit

  /**
    * 发送消息
    *
    * @param message 消息
    * @return 是否成功 ,返回对应的消息ID（自动生成）和message
    */
  def sendFuture(message: String): Future[Resp[(String, String)]]

	/**
    * 关闭当前生产者
    */
  def close(): Unit

}

/**
  * 消费者类
  *
  * @param groupId            组ID，用于发布-订阅模式
  * @param topic              主题
  * @param autoCommit         是否自动提交
  * @param autoCommitInterval 自动提供间隔
  */
case class Consumer(groupId: String, topic: String, autoCommit: Boolean = false, autoCommitInterval: Long = DEFAULT_AUTO_COMMIT_INTERVAL) {

/**
    * 接收消息
    *
    * @param fun 收到消息后的回调方法
    */
  def receive(fun: ReceivedCallback): Unit

	/**
    * 关闭当前消费者
    */
  def close(): Unit

}

  /**
  * 关闭所有实例
  */
def close(): Unit</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truecontributing"><a class="anchor" href="#truecontributing"></a>15. Contributing</h2>
<div class="sectionbody">
<div class="sect3">
<h4 id="trueenvironment"><a class="anchor" href="#trueenvironment"></a>15.1. Environment</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>JDK 1.8</p>
</li>
<li>
<p>Scala 2.11</p>
</li>
<li>
<p>Mongo 3.x（可选）</p>
</li>
<li>
<p>Redis 3.x（可选）</p>
</li>
<li>
<p>Kafka 0.8.x（可选）</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="truebuild"><a class="anchor" href="#truebuild"></a>15.2. Build</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>git clone <a href="https://github.com/gudaoxuri/ez-framework.git" class="bare">https://github.com/gudaoxuri/ez-framework.git</a></code></p>
</li>
<li>
<p>使用IDE导入Maven工程，各组件都是独立Maven工程</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="truesubmit"><a class="anchor" href="#truesubmit"></a>15.3. Submit</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>提交前请确保:</p>
<div class="literalblock">
<div class="content">
<pre>已完成变更代码的单元测试
代码风格检查（mvn scalastyle:check）通过：0 errors 0 warnings</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="trueroadmap"><a class="anchor" href="#trueroadmap"></a>16. Roadmap</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="true3-1-0"><a class="anchor" href="#true3-1-0"></a>16.1. 3.1.0</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>动态多数据源 支持</p>
</li>
<li>
<p>SimpleRPC 添加排序、过滤等功能</p>
</li>
<li>
<p>i18n支持</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true3-0-0"><a class="anchor" href="#true3-0-0"></a>16.2. 3.0.0</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>添加示例</p>
</li>
<li>
<p>更多的边界测试</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true3-0-0-snapshot"><a class="anchor" href="#true3-0-0-snapshot"></a>16.3. 3.0.0-SNAPSHOT</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>重写核心架构</p>
</li>
<li>
<p>规范代码组织</p>
</li>
<li>
<p>完善注释注解</p>
</li>
<li>
<p>添加示例代码</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truechangelog"><a class="anchor" href="#truechangelog"></a>17. ChangeLog</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="true3-0-0-2"><a class="anchor" href="#true3-0-0-2"></a>17.1. 3.0.0</h3>
<div class="sect3">
<h4 id="truefeatures"><a class="anchor" href="#truefeatures"></a>17.1.1. Features</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>核心架构重写</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="truebug-fixes"><a class="anchor" href="#truebug-fixes"></a>17.1.2. Bug Fixes</h4>

</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 3.0.0<br>
Last updated 2016-04-14 08:26:39
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>